{"version":3,"file":"static/webpack/static\\development\\pages\\_app.js.97710122593cf82b4e43.hot-update.js","sources":["webpack:///./lib/withRedux.js"],"sourcesContent":["import React from 'react'\r\nimport initialStore from '../store'\r\nconst isServer=typeof window==='undefined'\r\nconst _NEXT_REDUX_STORE='_NEXT_REDUX_STORE'\r\nfunction getOrCreateStore(initialState={}){\r\n  if(isServer){\r\n    return initialStore(initialState)\r\n  }\r\n  if(!window[_NEXT_REDUX_STORE]){\r\n    window[_NEXT_REDUX_STORE]=initialStore(initialState)\r\n  }\r\n  return window[_NEXT_REDUX_STORE]\r\n}\r\nexport default Comp=>{\r\n  class WithReduxApp extends React.Component{\r\n    constructor(props){\r\n      super(props)\r\n      this.reduxStore=getOrCreateStore(props.initialReduxState)\r\n    }\r\n    render(){\r\n    const {Component,pageProps,...rest}=this.props\r\n    return(\r\n      <Comp {...rest} pageProp={pageProps} reduxStore={this.reduxStore} Component={Component}/>\r\n    )\r\n  }\r\n  }\r\n  \r\n  WithReduxApp.getInitialProps=async ctx=>{\r\n    let reduxStore\r\n    if(isServer){\r\n      const {req={}}=ctx.ctx\r\n      const session=req.session\r\n      if(session&&session.userInfo){\r\n        reduxStore=getOrCreateStore({\r\n          user:session.userInfo\r\n        })//只是为了获取初始值\r\n      }else{\r\n        reduxStore=getOrCreateStore()\r\n      }\r\n    }\r\n    else{\r\n      reduxStore=getOrCreateStore()\r\n    }\r\n    ctx.reduxStore=reduxStore\r\n    let appProps = {}\r\n    if (typeof Comp.getInitialProps === 'function') {\r\n      appProps = await Comp.getInitialProps(ctx)\r\n    }\r\n    return {\r\n      ...appProps,\r\n      initialReduxState: reduxStore.getState(),\r\n    }\r\n}\r\nreturn WithReduxApp\r\n}\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AACA;AADA;AACA;AAAA;AACA;AAFA;AAGA;AACA;AANA;AAAA;AAAA;AAMA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAEA;AAXA;AACA;AADA;AAAA;AACA;AAaA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAEA;AAAA;AAEA;AACA;AAAA;AACA;AACA;AADA;AAGA;AACA;AACA;AACA;AAEA;AACA;AACA;AAAA;AACA;AACA;AAlBA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AACA;AADA;AAmBA;AACA;AApBA;AAAA;AAuBA;AAvBA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AAyBA;AACA;;;;A","sourceRoot":""}