{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _Row from \"antd/lib/row\";\nimport _Pagination from \"antd/lib/pagination\";\nimport _Col from \"antd/lib/col\";\nimport _List from \"antd/lib/list\";\nimport _extends from \"@babel/runtime-corejs2/helpers/esm/extends\";\nimport _JSXStyle from \"styled-jsx/style\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { memo, isValidElement, useEffect } from 'react';\nimport { withRouter } from 'next/router';\nimport Link from 'next/link';\nimport api from '../lib/api';\nimport { cacheArray } from '../lib/repo-cache';\nimport Repo from '../components/Repo';\nvar LANGUAGE = ['JavaScript', 'HTML', 'CSS', 'TypeScript', 'Java', 'Python'];\nvar SORT_TYPE = [{\n  name: 'Best Match'\n}, {\n  name: 'Most Stars',\n  value: 'stars',\n  order: 'desc' // 降序\n\n}, {\n  name: 'Fewest Stars',\n  value: 'stars',\n  order: 'asc'\n}, {\n  name: 'Most Forks',\n  value: 'forks',\n  order: 'desc'\n}, {\n  name: 'Fewest Forks',\n  value: 'forks',\n  order: 'asc'\n}];\nvar selectedItemStyle = {\n  borderLeft: '2px solid #e36209',\n  fontWeight: 'bold'\n};\nvar per_page = 20;\nvar FilterLink = memo(function (_ref) {\n  var query = _ref.query,\n      sort = _ref.sort,\n      lang = _ref.lang,\n      order = _ref.order,\n      page = _ref.page,\n      per_page = _ref.per_page,\n      name = _ref.name;\n  var queryString = \"?query=\".concat(query);\n  if (lang) queryString += \"+language:\".concat(lang);\n  if (sort) queryString += \"&sort=\".concat(sort, \"&order=\").concat(order || 'desc');\n  if (page) queryString += \"&page=\".concat(page);\n  queryString += \"&per_page=\".concat(per_page);\n  return __jsx(Link, {\n    href: queryString\n  }, isValidElement(name) ? name : __jsx(\"a\", null, name));\n});\n\nfunction noop() {}\n\nvar isServer = false;\n\nvar Search = function Search(_ref2) {\n  var router = _ref2.router,\n      repos = _ref2.repos;\n  useEffect(function () {\n    !isServer && cacheArray(repos.items);\n  });\n  var query = router.query;\n  var _router$query = router.query,\n      lang = _router$query.lang,\n      sort = _router$query.sort,\n      order = _router$query.order,\n      page = _router$query.page;\n  return __jsx(\"div\", {\n    className: \"jsx-2550782761\" + \" \" + \"root\"\n  }, __jsx(_Row, {\n    gutter: 20\n  }, __jsx(_Col, {\n    span: 6\n  }, __jsx(_List, {\n    bordered: true,\n    header: __jsx(\"span\", {\n      className: \"jsx-2550782761\" + \" \" + \"list-header\"\n    }, \"\\u8BED\\u8A00\"),\n    style: {\n      marginBottom: 20\n    },\n    dataSource: LANGUAGE,\n    renderItem: function renderItem(item) {\n      var selected = lang === item;\n      return __jsx(_List.Item, {\n        style: selected ? selectedItemStyle : null\n      }, selected ? __jsx(\"span\", {\n        className: \"jsx-2550782761\"\n      }, item) : __jsx(FilterLink, _extends({}, query, {\n        name: item,\n        lang: item\n      })));\n    }\n  }), __jsx(_List, {\n    bordered: true,\n    header: __jsx(\"span\", {\n      className: \"jsx-2550782761\" + \" \" + \"list-header\"\n    }, \"\\u6392\\u5E8F\"),\n    dataSource: SORT_TYPE,\n    renderItem: function renderItem(item) {\n      var selected = false;\n\n      if (item.name === 'Best Match' && !sort) {\n        selected = true;\n      } else if (item.value === sort && item.order === order) {\n        selected = true;\n      }\n\n      return __jsx(_List.Item, {\n        style: selected ? selectedItemStyle : null\n      }, selected ? __jsx(\"span\", {\n        className: \"jsx-2550782761\"\n      }, item.name) : __jsx(FilterLink, _extends({}, query, {\n        name: item.name,\n        sort: item.value,\n        order: item.order\n      })));\n    }\n  })), __jsx(_Col, {\n    span: 18\n  }, __jsx(\"h2\", {\n    className: \"jsx-2550782761\" + \" \" + \"repos-title\"\n  }, repos.total_count, \" \\u4E2A\\u4ED3\\u5E93\"), repos.items ? repos.items.map(function (repo) {\n    return __jsx(Repo, {\n      repo: repo,\n      key: repo.id\n    });\n  }) : '暂无相关仓库', __jsx(\"div\", {\n    className: \"jsx-2550782761\" + \" \" + \"pagination\"\n  }, __jsx(_Pagination, {\n    pageSize: per_page,\n    current: Number(page) || 1,\n    total: repos.total_count > 1000 ? 1000 : repos.total_count,\n    onChange: noop,\n    itemRender: function itemRender(page, type, ol) {\n      var p = type === 'page' ? page : type === 'prev' ? page - 1 : page + 1;\n      var name = type === 'page' ? page : ol;\n      return __jsx(FilterLink, _extends({}, query, {\n        page: p,\n        name: name\n      }));\n    }\n  })))), __jsx(_JSXStyle, {\n    id: \"2550782761\"\n  }, \".root.jsx-2550782761{padding:20px 0;}.list-header.jsx-2550782761{font-weight:800;font-size:16px;}.repos-title.jsx-2550782761{border-bottom:1px solid #eee;font-size:24px;line-height:50px;}.pagination.jsx-2550782761{padding:20px;text-align:center;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbWFyaW1vXFxEZXNrdG9wXFxuZXh0LWdpdGh1YlxccGFnZXNcXHNlYXJjaC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFxSW9CLEFBRzRCLEFBR0MsQUFJYSxBQUtmLGFBQ0ksRUFacEIsQ0FHaUIsYUFJQSxFQUhqQixBQVNBLGFBTG1CLGlCQUNuQiIsImZpbGUiOiJDOlxcVXNlcnNcXG1hcmltb1xcRGVza3RvcFxcbmV4dC1naXRodWJcXHBhZ2VzXFxzZWFyY2guanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge21lbW8saXNWYWxpZEVsZW1lbnQsIHVzZUVmZmVjdH0gZnJvbSAncmVhY3QnXHJcbmltcG9ydCB7d2l0aFJvdXRlcn0gZnJvbSAnbmV4dC9yb3V0ZXInXHJcbmltcG9ydCB7IFJvdywgQ29sLCBMaXN0ICxQYWdpbmF0aW9ufSBmcm9tICdhbnRkJ1xyXG5pbXBvcnQgTGluayBmcm9tICduZXh0L2xpbmsnXHJcblxyXG5pbXBvcnQgYXBpIGZyb20gJy4uL2xpYi9hcGknXHJcbmltcG9ydCB7IGNhY2hlQXJyYXkgfSBmcm9tICcuLi9saWIvcmVwby1jYWNoZSdcclxuaW1wb3J0IFJlcG8gZnJvbSAnLi4vY29tcG9uZW50cy9SZXBvJ1xyXG5cclxuY29uc3QgTEFOR1VBR0UgPSBbJ0phdmFTY3JpcHQnLCAnSFRNTCcsICdDU1MnLCAnVHlwZVNjcmlwdCcsICdKYXZhJywgJ1B5dGhvbiddXHJcbmNvbnN0IFNPUlRfVFlQRSA9IFtcclxuICB7XHJcbiAgICBuYW1lOiAnQmVzdCBNYXRjaCdcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6ICdNb3N0IFN0YXJzJyxcclxuICAgIHZhbHVlOiAnc3RhcnMnLFxyXG4gICAgb3JkZXI6ICdkZXNjJyAvLyDpmY3luo9cclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6ICdGZXdlc3QgU3RhcnMnLFxyXG4gICAgdmFsdWU6ICdzdGFycycsXHJcbiAgICBvcmRlcjogJ2FzYydcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6ICdNb3N0IEZvcmtzJyxcclxuICAgIHZhbHVlOiAnZm9ya3MnLFxyXG4gICAgb3JkZXI6ICdkZXNjJ1xyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogJ0Zld2VzdCBGb3JrcycsXHJcbiAgICB2YWx1ZTogJ2ZvcmtzJyxcclxuICAgIG9yZGVyOiAnYXNjJ1xyXG4gIH1cclxuXVxyXG5jb25zdCBzZWxlY3RlZEl0ZW1TdHlsZSA9IHtcclxuICBib3JkZXJMZWZ0OiAnMnB4IHNvbGlkICNlMzYyMDknLFxyXG4gIGZvbnRXZWlnaHQ6ICdib2xkJ1xyXG59XHJcbmNvbnN0IHBlcl9wYWdlPTIwXHJcbmNvbnN0IEZpbHRlckxpbms9bWVtbygoe3F1ZXJ5LCBzb3J0LCBsYW5nLCBvcmRlciwgcGFnZSwgcGVyX3BhZ2UsbmFtZX0pPT57XHJcbiAgbGV0IHF1ZXJ5U3RyaW5nID0gYD9xdWVyeT0ke3F1ZXJ5fWBcclxuICBpZiAobGFuZykgcXVlcnlTdHJpbmcgKz0gYCtsYW5ndWFnZToke2xhbmd9YFxyXG4gIGlmIChzb3J0KSBxdWVyeVN0cmluZyArPSBgJnNvcnQ9JHtzb3J0fSZvcmRlcj0ke29yZGVyIHx8ICdkZXNjJ31gXHJcbiAgaWYgKHBhZ2UpIHF1ZXJ5U3RyaW5nICs9IGAmcGFnZT0ke3BhZ2V9YFxyXG4gIHF1ZXJ5U3RyaW5nICs9IGAmcGVyX3BhZ2U9JHtwZXJfcGFnZX1gXHJcbiAgcmV0dXJuIDxMaW5rIGhyZWY9e3F1ZXJ5U3RyaW5nfT5cclxuICAgIHtpc1ZhbGlkRWxlbWVudChuYW1lKT9uYW1lOjxhPntuYW1lfTwvYT59XHJcbiAgPC9MaW5rPlxyXG59KVxyXG5cclxuZnVuY3Rpb24gbm9vcCgpIHt9XHJcbmNvbnN0IGlzU2VydmVyID0gdHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCdcclxuXHJcbmNvbnN0IFNlYXJjaD0oe3JvdXRlciwgcmVwb3N9KT0+e1xyXG4gIHVzZUVmZmVjdCgoKT0+e1xyXG4gICAgIWlzU2VydmVyJiZjYWNoZUFycmF5KHJlcG9zLml0ZW1zKVxyXG4gIH0pXHJcbiAgY29uc3QgcXVlcnkgPSByb3V0ZXIucXVlcnlcclxuICBjb25zdCB7IGxhbmcsIHNvcnQsIG9yZGVyLCBwYWdlIH0gPSByb3V0ZXIucXVlcnlcclxuICByZXR1cm4gPGRpdiBjbGFzc05hbWU9XCJyb290XCI+XHJcbiAgICAgICAgPFJvdyBndXR0ZXI9ezIwfT5cclxuICAgICAgICAgIDxDb2wgc3Bhbj17Nn0+XHJcbiAgICAgICAgICAgIDxMaXN0XHJcbiAgICAgICAgICAgICAgYm9yZGVyZWRcclxuICAgICAgICAgICAgICBoZWFkZXI9ezxzcGFuIGNsYXNzTmFtZT1cImxpc3QtaGVhZGVyXCI+6K+t6KiAPC9zcGFuPn1cclxuICAgICAgICAgICAgICBzdHlsZT17eyBtYXJnaW5Cb3R0b206IDIwIH19XHJcbiAgICAgICAgICAgICAgZGF0YVNvdXJjZT17TEFOR1VBR0V9XHJcbiAgICAgICAgICAgICAgcmVuZGVySXRlbT17aXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RlZCA9IGxhbmcgPT09IGl0ZW1cclxuICAgICAgICAgICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgICAgICAgIDxMaXN0Lkl0ZW0gc3R5bGU9e3NlbGVjdGVkID8gc2VsZWN0ZWRJdGVtU3R5bGUgOiBudWxsfT5cclxuICAgICAgICAgICAgICAgICAgICAgIHtzZWxlY3RlZCA/IChcclxuICAgICAgICAgICAgICAgICAgICA8c3Bhbj57aXRlbX08L3NwYW4+XHJcbiAgICAgICAgICAgICAgICAgICkgOiAoXHJcbiAgICAgICAgICAgICAgICAgICAgPEZpbHRlckxpbmsgey4uLnF1ZXJ5fSBuYW1lPXtpdGVtfSBsYW5nPXtpdGVtfSAvPlxyXG4gICAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgICAgICA8L0xpc3QuSXRlbT5cclxuICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICB9fVxyXG4gICAgICAgICAgICA+PC9MaXN0PlxyXG4gICAgICAgICAgICA8TGlzdFxyXG4gICAgICAgICAgICAgIGJvcmRlcmVkXHJcbiAgICAgICAgICAgICAgaGVhZGVyPXs8c3BhbiBjbGFzc05hbWU9XCJsaXN0LWhlYWRlclwiPuaOkuW6jzwvc3Bhbj59XHJcbiAgICAgICAgICAgICAgZGF0YVNvdXJjZT17U09SVF9UWVBFfVxyXG4gICAgICAgICAgICAgIHJlbmRlckl0ZW09e2l0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgbGV0IHNlbGVjdGVkID0gZmFsc2VcclxuICAgICAgICAgICAgICAgIGlmIChpdGVtLm5hbWUgPT09ICdCZXN0IE1hdGNoJyAmJiAhc29ydCkge1xyXG4gICAgICAgICAgICAgICAgICBzZWxlY3RlZCA9IHRydWVcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaXRlbS52YWx1ZSA9PT0gc29ydCAmJiBpdGVtLm9yZGVyID09PSBvcmRlcikge1xyXG4gICAgICAgICAgICAgICAgICBzZWxlY3RlZCA9IHRydWVcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgICAgICAgIDxMaXN0Lkl0ZW0gc3R5bGU9e3NlbGVjdGVkID8gc2VsZWN0ZWRJdGVtU3R5bGUgOiBudWxsfT5cclxuICAgICAgICAgICAgICAgICAgICB7c2VsZWN0ZWQgPyAoXHJcbiAgICAgICAgICAgICAgICAgICAgPHNwYW4+e2l0ZW0ubmFtZX08L3NwYW4+XHJcbiAgICAgICAgICAgICAgICAgICkgOiAoXHJcbiAgICAgICAgICAgICAgICAgICAgPEZpbHRlckxpbmtcclxuICAgICAgICAgICAgICAgICAgICAgIHsuLi5xdWVyeX1cclxuICAgICAgICAgICAgICAgICAgICAgIG5hbWU9e2l0ZW0ubmFtZX1cclxuICAgICAgICAgICAgICAgICAgICAgIHNvcnQ9e2l0ZW0udmFsdWV9XHJcbiAgICAgICAgICAgICAgICAgICAgICBvcmRlcj17aXRlbS5vcmRlcn1cclxuICAgICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgICAgICA8L0xpc3QuSXRlbT5cclxuICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICB9fVxyXG4gICAgICAgICAgICA+XHJcbiAgICAgICAgICAgIDwvTGlzdD5cclxuICAgICAgICAgIDwvQ29sPlxyXG4gICAgICAgICAgPENvbCBzcGFuPXsxOH0+XHJcbiAgICAgICAgICA8aDIgY2xhc3NOYW1lPVwicmVwb3MtdGl0bGVcIj57cmVwb3MudG90YWxfY291bnR9IOS4quS7k+W6kzwvaDI+XHJcbiAgICAgICAgICB7cmVwb3MuaXRlbXNcclxuICAgICAgICAgID9yZXBvcy5pdGVtcy5tYXAocmVwbyA9PiAoXHJcbiAgICAgICAgICAgIDxSZXBvIHJlcG89e3JlcG99IGtleT17cmVwby5pZH0gLz5cclxuICAgICAgICAgICkpXHJcbiAgICAgICAgICA6J+aaguaXoOebuOWFs+S7k+W6kydcclxuICAgICAgICB9XHJcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInBhZ2luYXRpb25cIj5cclxuICAgICAgICAgICAgPFBhZ2luYXRpb25cclxuICAgICAgICAgICAgICBwYWdlU2l6ZT17cGVyX3BhZ2V9XHJcbiAgICAgICAgICAgICAgY3VycmVudD17TnVtYmVyKHBhZ2UpIHx8IDF9XHJcbiAgICAgICAgICAgICAgdG90YWw9e3JlcG9zLnRvdGFsX2NvdW50PjEwMDA/MTAwMDpyZXBvcy50b3RhbF9jb3VudH1cclxuICAgICAgICAgICAgICBvbkNoYW5nZT17bm9vcH1cclxuICAgICAgICAgICAgICBpdGVtUmVuZGVyPXsocGFnZSwgdHlwZSwgb2wpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHAgPSB0eXBlID09PSAncGFnZSc/IHBhZ2U6ICh0eXBlID09PSAncHJldicgPyBwYWdlIC0xIDogcGFnZSArMSlcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5hbWUgPSB0eXBlID09PSAncGFnZScgPyBwYWdlIDogb2xcclxuICAgICAgICAgICAgICAgIHJldHVybiA8RmlsdGVyTGluayB7Li4ucXVlcnl9IHBhZ2U9e3B9IG5hbWU9e25hbWV9Lz5cclxuICAgICAgICAgICAgICB9fVxyXG4gICAgICAgICAgICAvPlxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPC9Db2w+XHJcbiAgICAgICAgPC9Sb3c+XHJcbiAgICAgICAgPHN0eWxlIGpzeD57YFxyXG4gICAgICAgICAgLnJvb3Qge1xyXG4gICAgICAgICAgICBwYWRkaW5nOiAyMHB4IDA7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICAubGlzdC1oZWFkZXIge1xyXG4gICAgICAgICAgICBmb250LXdlaWdodDogODAwO1xyXG4gICAgICAgICAgICBmb250LXNpemU6IDE2cHg7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICAucmVwb3MtdGl0bGUge1xyXG4gICAgICAgICAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgI2VlZTtcclxuICAgICAgICAgICAgZm9udC1zaXplOiAyNHB4O1xyXG4gICAgICAgICAgICBsaW5lLWhlaWdodDogNTBweDtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIC5wYWdpbmF0aW9uIHtcclxuICAgICAgICAgICAgcGFkZGluZzogMjBweCA7XHJcbiAgICAgICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjtcclxuICAgICAgICAgIH1cclxuICAgICAgICBgfTwvc3R5bGU+XHJcbiAgICAgICAgPC9kaXY+XHJcbn1cclxuLy8gZ2l0aHVi6ZmQ5Yi277yM5pCc57Si57uT5p6c5Y+q6IO957uZ5YmNMTAwMOS4qlxyXG5TZWFyY2guZ2V0SW5pdGlhbFByb3BzID0gYXN5bmMgKHsgY3R4IH0pID0+IHtcclxuICBjb25zdCB7IHF1ZXJ5LCBzb3J0LCBsYW5nLCBvcmRlciwgcGFnZSwgcGVyX3BhZ2UgfSA9IGN0eC5xdWVyeVxyXG5cclxuICBpZiAoIXF1ZXJ5KSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICByZXBvczoge1xyXG4gICAgICAgIHRvdGFsX2NvdW50OiAwXHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIOaLvOaOpeivt+axguaOpeWPo+WPguaVsFxyXG4gIC8vIOS+i+WtkDogP3E9cmVhY3QrbGFuZ3VhZ2U6cmVhY3Qmc29ydD1zdGFycyZvcmRlcj1kZXNjJnBhZ2U9MlxyXG4gIGxldCBxdWVyeVN0cmluZyA9IGA/cT0ke3F1ZXJ5fWBcclxuICBpZiAobGFuZykgcXVlcnlTdHJpbmcgKz0gYCtsYW5ndWFnZToke2xhbmd9YFxyXG4gIGlmIChzb3J0KSBxdWVyeVN0cmluZyArPSBgJnNvcnQ9JHtzb3J0fSZvcmRlcj0ke29yZGVyIHx8ICdkZXNjJ31gXHJcbiAgaWYgKHBhZ2UpIHF1ZXJ5U3RyaW5nICs9IGAmcGFnZT0ke3BhZ2V9YFxyXG4gIHF1ZXJ5U3RyaW5nICs9IGAmcGVyX3BhZ2U9JHtwZXJfcGFnZX1gXHJcblxyXG4gIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGFwaS5yZXF1ZXN0KFxyXG4gICAgeyB1cmw6IGAvc2VhcmNoL3JlcG9zaXRvcmllcyR7cXVlcnlTdHJpbmd9YCB9LFxyXG4gICAgY3R4LnJlcSxcclxuICAgIGN0eC5yZXNcclxuICApXHJcbiAgICBpZihpc1NlcnZlcil7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgcmVwb3M6IHJlc3VsdC5kYXRhfHx7fVxyXG4gICAgICB9XHJcbiAgICB9ZWxzZXtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICByZXBvczogcmVzdWx0LmRhdGEuZGF0YXx8e31cclxuICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCB3aXRoUm91dGVyKFNlYXJjaCkiXX0= */\\n/*@ sourceURL=C:\\\\Users\\\\marimo\\\\Desktop\\\\next-github\\\\pages\\\\search.js */\"));\n}; // github限制，搜索结果只能给前1000个\n\n\nSearch.getInitialProps =\n/*#__PURE__*/\nfunction () {\n  var _ref4 = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee(_ref3) {\n    var ctx, _ctx$query, query, sort, lang, order, page, per_page, queryString, result;\n\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            ctx = _ref3.ctx;\n            _ctx$query = ctx.query, query = _ctx$query.query, sort = _ctx$query.sort, lang = _ctx$query.lang, order = _ctx$query.order, page = _ctx$query.page, per_page = _ctx$query.per_page;\n\n            if (query) {\n              _context.next = 4;\n              break;\n            }\n\n            return _context.abrupt(\"return\", {\n              repos: {\n                total_count: 0\n              }\n            });\n\n          case 4:\n            // 拼接请求接口参数\n            // 例子: ?q=react+language:react&sort=stars&order=desc&page=2\n            queryString = \"?q=\".concat(query);\n            if (lang) queryString += \"+language:\".concat(lang);\n            if (sort) queryString += \"&sort=\".concat(sort, \"&order=\").concat(order || 'desc');\n            if (page) queryString += \"&page=\".concat(page);\n            queryString += \"&per_page=\".concat(per_page);\n            _context.next = 11;\n            return api.request({\n              url: \"/search/repositories\".concat(queryString)\n            }, ctx.req, ctx.res);\n\n          case 11:\n            result = _context.sent;\n\n            if (!isServer) {\n              _context.next = 16;\n              break;\n            }\n\n            return _context.abrupt(\"return\", {\n              repos: result.data || {}\n            });\n\n          case 16:\n            return _context.abrupt(\"return\", {\n              repos: result.data.data || {}\n            });\n\n          case 17:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function (_x) {\n    return _ref4.apply(this, arguments);\n  };\n}();\n\nexport default withRouter(Search);","map":{"version":3,"sources":["C:\\Users\\marimo\\Desktop\\next-github\\pages\\search.js"],"names":["memo","isValidElement","useEffect","withRouter","Link","api","cacheArray","Repo","LANGUAGE","SORT_TYPE","name","value","order","selectedItemStyle","borderLeft","fontWeight","per_page","FilterLink","query","sort","lang","page","queryString","noop","isServer","Search","router","repos","items","marginBottom","item","selected","total_count","map","repo","id","Number","type","ol","p","getInitialProps","ctx","request","url","req","res","result","data"],"mappings":"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","sourcesContent":["import {memo,isValidElement, useEffect} from 'react'\r\nimport {withRouter} from 'next/router'\r\nimport { Row, Col, List ,Pagination} from 'antd'\r\nimport Link from 'next/link'\r\n\r\nimport api from '../lib/api'\r\nimport { cacheArray } from '../lib/repo-cache'\r\nimport Repo from '../components/Repo'\r\n\r\nconst LANGUAGE = ['JavaScript', 'HTML', 'CSS', 'TypeScript', 'Java', 'Python']\r\nconst SORT_TYPE = [\r\n  {\r\n    name: 'Best Match'\r\n  },\r\n  {\r\n    name: 'Most Stars',\r\n    value: 'stars',\r\n    order: 'desc' // 降序\r\n  },\r\n  {\r\n    name: 'Fewest Stars',\r\n    value: 'stars',\r\n    order: 'asc'\r\n  },\r\n  {\r\n    name: 'Most Forks',\r\n    value: 'forks',\r\n    order: 'desc'\r\n  },\r\n  {\r\n    name: 'Fewest Forks',\r\n    value: 'forks',\r\n    order: 'asc'\r\n  }\r\n]\r\nconst selectedItemStyle = {\r\n  borderLeft: '2px solid #e36209',\r\n  fontWeight: 'bold'\r\n}\r\nconst per_page=20\r\nconst FilterLink=memo(({query, sort, lang, order, page, per_page,name})=>{\r\n  let queryString = `?query=${query}`\r\n  if (lang) queryString += `+language:${lang}`\r\n  if (sort) queryString += `&sort=${sort}&order=${order || 'desc'}`\r\n  if (page) queryString += `&page=${page}`\r\n  queryString += `&per_page=${per_page}`\r\n  return <Link href={queryString}>\r\n    {isValidElement(name)?name:<a>{name}</a>}\r\n  </Link>\r\n})\r\n\r\nfunction noop() {}\r\nconst isServer = typeof window === 'undefined'\r\n\r\nconst Search=({router, repos})=>{\r\n  useEffect(()=>{\r\n    !isServer&&cacheArray(repos.items)\r\n  })\r\n  const query = router.query\r\n  const { lang, sort, order, page } = router.query\r\n  return <div className=\"root\">\r\n        <Row gutter={20}>\r\n          <Col span={6}>\r\n            <List\r\n              bordered\r\n              header={<span className=\"list-header\">语言</span>}\r\n              style={{ marginBottom: 20 }}\r\n              dataSource={LANGUAGE}\r\n              renderItem={item => {\r\n                const selected = lang === item\r\n                return (\r\n                  <List.Item style={selected ? selectedItemStyle : null}>\r\n                      {selected ? (\r\n                    <span>{item}</span>\r\n                  ) : (\r\n                    <FilterLink {...query} name={item} lang={item} />\r\n                  )}\r\n                  </List.Item>\r\n                )\r\n              }}\r\n            ></List>\r\n            <List\r\n              bordered\r\n              header={<span className=\"list-header\">排序</span>}\r\n              dataSource={SORT_TYPE}\r\n              renderItem={item => {\r\n                let selected = false\r\n                if (item.name === 'Best Match' && !sort) {\r\n                  selected = true\r\n                } else if (item.value === sort && item.order === order) {\r\n                  selected = true\r\n                }\r\n                return (\r\n                  <List.Item style={selected ? selectedItemStyle : null}>\r\n                    {selected ? (\r\n                    <span>{item.name}</span>\r\n                  ) : (\r\n                    <FilterLink\r\n                      {...query}\r\n                      name={item.name}\r\n                      sort={item.value}\r\n                      order={item.order}\r\n                    />\r\n                  )}\r\n                  </List.Item>\r\n                )\r\n              }}\r\n            >\r\n            </List>\r\n          </Col>\r\n          <Col span={18}>\r\n          <h2 className=\"repos-title\">{repos.total_count} 个仓库</h2>\r\n          {repos.items\r\n          ?repos.items.map(repo => (\r\n            <Repo repo={repo} key={repo.id} />\r\n          ))\r\n          :'暂无相关仓库'\r\n        }\r\n          <div className=\"pagination\">\r\n            <Pagination\r\n              pageSize={per_page}\r\n              current={Number(page) || 1}\r\n              total={repos.total_count>1000?1000:repos.total_count}\r\n              onChange={noop}\r\n              itemRender={(page, type, ol) => {\r\n                const p = type === 'page'? page: (type === 'prev' ? page -1 : page +1)\r\n                const name = type === 'page' ? page : ol\r\n                return <FilterLink {...query} page={p} name={name}/>\r\n              }}\r\n            />\r\n          </div>\r\n        </Col>\r\n        </Row>\r\n        <style jsx>{`\r\n          .root {\r\n            padding: 20px 0;\r\n          }\r\n          .list-header {\r\n            font-weight: 800;\r\n            font-size: 16px;\r\n          }\r\n          .repos-title {\r\n            border-bottom: 1px solid #eee;\r\n            font-size: 24px;\r\n            line-height: 50px;\r\n          }\r\n          .pagination {\r\n            padding: 20px ;\r\n            text-align: center;\r\n          }\r\n        `}</style>\r\n        </div>\r\n}\r\n// github限制，搜索结果只能给前1000个\r\nSearch.getInitialProps = async ({ ctx }) => {\r\n  const { query, sort, lang, order, page, per_page } = ctx.query\r\n\r\n  if (!query) {\r\n    return {\r\n      repos: {\r\n        total_count: 0\r\n      }\r\n    }\r\n  }\r\n\r\n  // 拼接请求接口参数\r\n  // 例子: ?q=react+language:react&sort=stars&order=desc&page=2\r\n  let queryString = `?q=${query}`\r\n  if (lang) queryString += `+language:${lang}`\r\n  if (sort) queryString += `&sort=${sort}&order=${order || 'desc'}`\r\n  if (page) queryString += `&page=${page}`\r\n  queryString += `&per_page=${per_page}`\r\n\r\n  const result = await api.request(\r\n    { url: `/search/repositories${queryString}` },\r\n    ctx.req,\r\n    ctx.res\r\n  )\r\n    if(isServer){\r\n      return {\r\n        repos: result.data||{}\r\n      }\r\n    }else{\r\n      return {\r\n        repos: result.data.data||{}\r\n      }\r\n    }\r\n}\r\n\r\nexport default withRouter(Search)"]},"metadata":{},"sourceType":"module"}