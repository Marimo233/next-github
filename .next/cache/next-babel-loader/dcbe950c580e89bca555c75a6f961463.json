{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _Row from \"antd/lib/row\";\nimport _Pagination from \"antd/lib/pagination\";\nimport _Col from \"antd/lib/col\";\nimport _List from \"antd/lib/list\";\nimport _extends from \"@babel/runtime-corejs2/helpers/esm/extends\";\nimport _JSXStyle from \"styled-jsx/style\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { memo, isValidElement, useEffect } from 'react';\nimport { withRouter } from 'next/router';\nimport Link from 'next/link';\nimport api from '../lib/api';\nimport { cacheArray } from '../lib/repo-cache';\nimport Repo from '../components/Repo';\nvar LANGUAGE = ['JavaScript', 'HTML', 'CSS', 'TypeScript', 'Java', 'Python'];\nvar SORT_TYPE = [{\n  name: 'Best Match'\n}, {\n  name: 'Most Stars',\n  value: 'stars',\n  order: 'desc' // 降序\n\n}, {\n  name: 'Fewest Stars',\n  value: 'stars',\n  order: 'asc'\n}, {\n  name: 'Most Forks',\n  value: 'forks',\n  order: 'desc'\n}, {\n  name: 'Fewest Forks',\n  value: 'forks',\n  order: 'asc'\n}];\nvar selectedItemStyle = {\n  borderLeft: '2px solid #e36209',\n  fontWeight: 'bold'\n};\nvar per_page = 20;\nvar FilterLink = memo(function (_ref) {\n  var query = _ref.query,\n      sort = _ref.sort,\n      lang = _ref.lang,\n      order = _ref.order,\n      page = _ref.page,\n      per_page = _ref.per_page,\n      name = _ref.name;\n  var queryString = \"?query=\".concat(query);\n  if (lang) queryString += \"+language:\".concat(lang);\n  if (sort) queryString += \"&sort=\".concat(sort, \"&order=\").concat(order || 'desc');\n  if (page) queryString += \"&page=\".concat(page);\n  queryString += \"&per_page=\".concat(per_page);\n  return __jsx(Link, {\n    href: queryString\n  }, isValidElement(name) ? name : __jsx(\"a\", null, name));\n});\n\nfunction noop() {}\n\nvar isServer = false;\n\nvar Search = function Search(_ref2) {\n  var router = _ref2.router,\n      repos = _ref2.repos;\n  useEffect(function () {\n    !isServer && cacheArray(repos.item);\n  });\n  var query = router.query;\n  var _router$query = router.query,\n      lang = _router$query.lang,\n      sort = _router$query.sort,\n      order = _router$query.order,\n      page = _router$query.page;\n  return __jsx(\"div\", {\n    className: \"jsx-2550782761\" + \" \" + \"root\"\n  }, __jsx(_Row, {\n    gutter: 20\n  }, __jsx(_Col, {\n    span: 6\n  }, __jsx(_List, {\n    bordered: true,\n    header: __jsx(\"span\", {\n      className: \"jsx-2550782761\" + \" \" + \"list-header\"\n    }, \"\\u8BED\\u8A00\"),\n    style: {\n      marginBottom: 20\n    },\n    dataSource: LANGUAGE,\n    renderItem: function renderItem(item) {\n      var selected = lang === item;\n      return __jsx(_List.Item, {\n        style: selected ? selectedItemStyle : null\n      }, selected ? __jsx(\"span\", {\n        className: \"jsx-2550782761\"\n      }, item) : __jsx(FilterLink, _extends({}, query, {\n        name: item,\n        lang: item\n      })));\n    }\n  }), __jsx(_List, {\n    bordered: true,\n    header: __jsx(\"span\", {\n      className: \"jsx-2550782761\" + \" \" + \"list-header\"\n    }, \"\\u6392\\u5E8F\"),\n    dataSource: SORT_TYPE,\n    renderItem: function renderItem(item) {\n      var selected = false;\n\n      if (item.name === 'Best Match' && !sort) {\n        selected = true;\n      } else if (item.value === sort && item.order === order) {\n        selected = true;\n      }\n\n      return __jsx(_List.Item, {\n        style: selected ? selectedItemStyle : null\n      }, selected ? __jsx(\"span\", {\n        className: \"jsx-2550782761\"\n      }, item.name) : __jsx(FilterLink, _extends({}, query, {\n        name: item.name,\n        sort: item.value,\n        order: item.order\n      })));\n    }\n  })), __jsx(_Col, {\n    span: 18\n  }, __jsx(\"h2\", {\n    className: \"jsx-2550782761\" + \" \" + \"repos-title\"\n  }, repos.total_count, \" \\u4E2A\\u4ED3\\u5E93\"), repos.items ? repos.items.map(function (repo) {\n    return __jsx(Repo, {\n      repo: repo,\n      key: repo.id\n    });\n  }) : '暂无相关仓库', __jsx(\"div\", {\n    className: \"jsx-2550782761\" + \" \" + \"pagination\"\n  }, __jsx(_Pagination, {\n    pageSize: per_page,\n    current: Number(page) || 1,\n    total: repos.total_count > 1000 ? 1000 : repos.total_count,\n    onChange: noop,\n    itemRender: function itemRender(page, type, ol) {\n      var p = type === 'page' ? page : type === 'prev' ? page - 1 : page + 1;\n      var name = type === 'page' ? page : ol;\n      return __jsx(FilterLink, _extends({}, query, {\n        page: p,\n        name: name\n      }));\n    }\n  })))), __jsx(_JSXStyle, {\n    id: \"2550782761\"\n  }, \".root.jsx-2550782761{padding:20px 0;}.list-header.jsx-2550782761{font-weight:800;font-size:16px;}.repos-title.jsx-2550782761{border-bottom:1px solid #eee;font-size:24px;line-height:50px;}.pagination.jsx-2550782761{padding:20px;text-align:center;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbWFyaW1vXFxEZXNrdG9wXFxuZXh0LWdpdGh1YlxccGFnZXNcXHNlYXJjaC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFxSW9CLEFBRzRCLEFBR0MsQUFJYSxBQUtmLGFBQ0ksRUFacEIsQ0FHaUIsYUFJQSxFQUhqQixBQVNBLGFBTG1CLGlCQUNuQiIsImZpbGUiOiJDOlxcVXNlcnNcXG1hcmltb1xcRGVza3RvcFxcbmV4dC1naXRodWJcXHBhZ2VzXFxzZWFyY2guanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge21lbW8saXNWYWxpZEVsZW1lbnQsIHVzZUVmZmVjdH0gZnJvbSAncmVhY3QnXHJcbmltcG9ydCB7d2l0aFJvdXRlcn0gZnJvbSAnbmV4dC9yb3V0ZXInXHJcbmltcG9ydCB7IFJvdywgQ29sLCBMaXN0ICxQYWdpbmF0aW9ufSBmcm9tICdhbnRkJ1xyXG5pbXBvcnQgTGluayBmcm9tICduZXh0L2xpbmsnXHJcblxyXG5pbXBvcnQgYXBpIGZyb20gJy4uL2xpYi9hcGknXHJcbmltcG9ydCB7IGNhY2hlQXJyYXkgfSBmcm9tICcuLi9saWIvcmVwby1jYWNoZSdcclxuaW1wb3J0IFJlcG8gZnJvbSAnLi4vY29tcG9uZW50cy9SZXBvJ1xyXG5cclxuY29uc3QgTEFOR1VBR0UgPSBbJ0phdmFTY3JpcHQnLCAnSFRNTCcsICdDU1MnLCAnVHlwZVNjcmlwdCcsICdKYXZhJywgJ1B5dGhvbiddXHJcbmNvbnN0IFNPUlRfVFlQRSA9IFtcclxuICB7XHJcbiAgICBuYW1lOiAnQmVzdCBNYXRjaCdcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6ICdNb3N0IFN0YXJzJyxcclxuICAgIHZhbHVlOiAnc3RhcnMnLFxyXG4gICAgb3JkZXI6ICdkZXNjJyAvLyDpmY3luo9cclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6ICdGZXdlc3QgU3RhcnMnLFxyXG4gICAgdmFsdWU6ICdzdGFycycsXHJcbiAgICBvcmRlcjogJ2FzYydcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6ICdNb3N0IEZvcmtzJyxcclxuICAgIHZhbHVlOiAnZm9ya3MnLFxyXG4gICAgb3JkZXI6ICdkZXNjJ1xyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogJ0Zld2VzdCBGb3JrcycsXHJcbiAgICB2YWx1ZTogJ2ZvcmtzJyxcclxuICAgIG9yZGVyOiAnYXNjJ1xyXG4gIH1cclxuXVxyXG5jb25zdCBzZWxlY3RlZEl0ZW1TdHlsZSA9IHtcclxuICBib3JkZXJMZWZ0OiAnMnB4IHNvbGlkICNlMzYyMDknLFxyXG4gIGZvbnRXZWlnaHQ6ICdib2xkJ1xyXG59XHJcbmNvbnN0IHBlcl9wYWdlPTIwXHJcbmNvbnN0IEZpbHRlckxpbms9bWVtbygoe3F1ZXJ5LCBzb3J0LCBsYW5nLCBvcmRlciwgcGFnZSwgcGVyX3BhZ2UsbmFtZX0pPT57XHJcbiAgbGV0IHF1ZXJ5U3RyaW5nID0gYD9xdWVyeT0ke3F1ZXJ5fWBcclxuICBpZiAobGFuZykgcXVlcnlTdHJpbmcgKz0gYCtsYW5ndWFnZToke2xhbmd9YFxyXG4gIGlmIChzb3J0KSBxdWVyeVN0cmluZyArPSBgJnNvcnQ9JHtzb3J0fSZvcmRlcj0ke29yZGVyIHx8ICdkZXNjJ31gXHJcbiAgaWYgKHBhZ2UpIHF1ZXJ5U3RyaW5nICs9IGAmcGFnZT0ke3BhZ2V9YFxyXG4gIHF1ZXJ5U3RyaW5nICs9IGAmcGVyX3BhZ2U9JHtwZXJfcGFnZX1gXHJcbiAgcmV0dXJuIDxMaW5rIGhyZWY9e3F1ZXJ5U3RyaW5nfT5cclxuICAgIHtpc1ZhbGlkRWxlbWVudChuYW1lKT9uYW1lOjxhPntuYW1lfTwvYT59XHJcbiAgPC9MaW5rPlxyXG59KVxyXG5cclxuZnVuY3Rpb24gbm9vcCgpIHt9XHJcbmNvbnN0IGlzU2VydmVyID0gdHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCdcclxuXHJcbmNvbnN0IFNlYXJjaD0oe3JvdXRlciwgcmVwb3N9KT0+e1xyXG4gIHVzZUVmZmVjdCgoKT0+e1xyXG4gICAgIWlzU2VydmVyJiZjYWNoZUFycmF5KHJlcG9zLml0ZW0pXHJcbiAgfSlcclxuICBjb25zdCBxdWVyeSA9IHJvdXRlci5xdWVyeVxyXG4gIGNvbnN0IHsgbGFuZywgc29ydCwgb3JkZXIsIHBhZ2UgfSA9IHJvdXRlci5xdWVyeVxyXG4gIHJldHVybiA8ZGl2IGNsYXNzTmFtZT1cInJvb3RcIj5cclxuICAgICAgICA8Um93IGd1dHRlcj17MjB9PlxyXG4gICAgICAgICAgPENvbCBzcGFuPXs2fT5cclxuICAgICAgICAgICAgPExpc3RcclxuICAgICAgICAgICAgICBib3JkZXJlZFxyXG4gICAgICAgICAgICAgIGhlYWRlcj17PHNwYW4gY2xhc3NOYW1lPVwibGlzdC1oZWFkZXJcIj7or63oqIA8L3NwYW4+fVxyXG4gICAgICAgICAgICAgIHN0eWxlPXt7IG1hcmdpbkJvdHRvbTogMjAgfX1cclxuICAgICAgICAgICAgICBkYXRhU291cmNlPXtMQU5HVUFHRX1cclxuICAgICAgICAgICAgICByZW5kZXJJdGVtPXtpdGVtID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkID0gbGFuZyA9PT0gaXRlbVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgICAgICAgPExpc3QuSXRlbSBzdHlsZT17c2VsZWN0ZWQgPyBzZWxlY3RlZEl0ZW1TdHlsZSA6IG51bGx9PlxyXG4gICAgICAgICAgICAgICAgICAgICAge3NlbGVjdGVkID8gKFxyXG4gICAgICAgICAgICAgICAgICAgIDxzcGFuPntpdGVtfTwvc3Bhbj5cclxuICAgICAgICAgICAgICAgICAgKSA6IChcclxuICAgICAgICAgICAgICAgICAgICA8RmlsdGVyTGluayB7Li4ucXVlcnl9IG5hbWU9e2l0ZW19IGxhbmc9e2l0ZW19IC8+XHJcbiAgICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAgICAgIDwvTGlzdC5JdGVtPlxyXG4gICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgIH19XHJcbiAgICAgICAgICAgID48L0xpc3Q+XHJcbiAgICAgICAgICAgIDxMaXN0XHJcbiAgICAgICAgICAgICAgYm9yZGVyZWRcclxuICAgICAgICAgICAgICBoZWFkZXI9ezxzcGFuIGNsYXNzTmFtZT1cImxpc3QtaGVhZGVyXCI+5o6S5bqPPC9zcGFuPn1cclxuICAgICAgICAgICAgICBkYXRhU291cmNlPXtTT1JUX1RZUEV9XHJcbiAgICAgICAgICAgICAgcmVuZGVySXRlbT17aXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICBsZXQgc2VsZWN0ZWQgPSBmYWxzZVxyXG4gICAgICAgICAgICAgICAgaWYgKGl0ZW0ubmFtZSA9PT0gJ0Jlc3QgTWF0Y2gnICYmICFzb3J0KSB7XHJcbiAgICAgICAgICAgICAgICAgIHNlbGVjdGVkID0gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpdGVtLnZhbHVlID09PSBzb3J0ICYmIGl0ZW0ub3JkZXIgPT09IG9yZGVyKSB7XHJcbiAgICAgICAgICAgICAgICAgIHNlbGVjdGVkID0gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgICAgICAgPExpc3QuSXRlbSBzdHlsZT17c2VsZWN0ZWQgPyBzZWxlY3RlZEl0ZW1TdHlsZSA6IG51bGx9PlxyXG4gICAgICAgICAgICAgICAgICAgIHtzZWxlY3RlZCA/IChcclxuICAgICAgICAgICAgICAgICAgICA8c3Bhbj57aXRlbS5uYW1lfTwvc3Bhbj5cclxuICAgICAgICAgICAgICAgICAgKSA6IChcclxuICAgICAgICAgICAgICAgICAgICA8RmlsdGVyTGlua1xyXG4gICAgICAgICAgICAgICAgICAgICAgey4uLnF1ZXJ5fVxyXG4gICAgICAgICAgICAgICAgICAgICAgbmFtZT17aXRlbS5uYW1lfVxyXG4gICAgICAgICAgICAgICAgICAgICAgc29ydD17aXRlbS52YWx1ZX1cclxuICAgICAgICAgICAgICAgICAgICAgIG9yZGVyPXtpdGVtLm9yZGVyfVxyXG4gICAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAgICAgIDwvTGlzdC5JdGVtPlxyXG4gICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgIH19XHJcbiAgICAgICAgICAgID5cclxuICAgICAgICAgICAgPC9MaXN0PlxyXG4gICAgICAgICAgPC9Db2w+XHJcbiAgICAgICAgICA8Q29sIHNwYW49ezE4fT5cclxuICAgICAgICAgIDxoMiBjbGFzc05hbWU9XCJyZXBvcy10aXRsZVwiPntyZXBvcy50b3RhbF9jb3VudH0g5Liq5LuT5bqTPC9oMj5cclxuICAgICAgICAgIHtyZXBvcy5pdGVtc1xyXG4gICAgICAgICAgP3JlcG9zLml0ZW1zLm1hcChyZXBvID0+IChcclxuICAgICAgICAgICAgPFJlcG8gcmVwbz17cmVwb30ga2V5PXtyZXBvLmlkfSAvPlxyXG4gICAgICAgICAgKSlcclxuICAgICAgICAgIDon5pqC5peg55u45YWz5LuT5bqTJ1xyXG4gICAgICAgIH1cclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicGFnaW5hdGlvblwiPlxyXG4gICAgICAgICAgICA8UGFnaW5hdGlvblxyXG4gICAgICAgICAgICAgIHBhZ2VTaXplPXtwZXJfcGFnZX1cclxuICAgICAgICAgICAgICBjdXJyZW50PXtOdW1iZXIocGFnZSkgfHwgMX1cclxuICAgICAgICAgICAgICB0b3RhbD17cmVwb3MudG90YWxfY291bnQ+MTAwMD8xMDAwOnJlcG9zLnRvdGFsX2NvdW50fVxyXG4gICAgICAgICAgICAgIG9uQ2hhbmdlPXtub29wfVxyXG4gICAgICAgICAgICAgIGl0ZW1SZW5kZXI9eyhwYWdlLCB0eXBlLCBvbCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcCA9IHR5cGUgPT09ICdwYWdlJz8gcGFnZTogKHR5cGUgPT09ICdwcmV2JyA/IHBhZ2UgLTEgOiBwYWdlICsxKVxyXG4gICAgICAgICAgICAgICAgY29uc3QgbmFtZSA9IHR5cGUgPT09ICdwYWdlJyA/IHBhZ2UgOiBvbFxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIDxGaWx0ZXJMaW5rIHsuLi5xdWVyeX0gcGFnZT17cH0gbmFtZT17bmFtZX0vPlxyXG4gICAgICAgICAgICAgIH19XHJcbiAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8L0NvbD5cclxuICAgICAgICA8L1Jvdz5cclxuICAgICAgICA8c3R5bGUganN4PntgXHJcbiAgICAgICAgICAucm9vdCB7XHJcbiAgICAgICAgICAgIHBhZGRpbmc6IDIwcHggMDtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIC5saXN0LWhlYWRlciB7XHJcbiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiA4MDA7XHJcbiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTZweDtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIC5yZXBvcy10aXRsZSB7XHJcbiAgICAgICAgICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjZWVlO1xyXG4gICAgICAgICAgICBmb250LXNpemU6IDI0cHg7XHJcbiAgICAgICAgICAgIGxpbmUtaGVpZ2h0OiA1MHB4O1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgLnBhZ2luYXRpb24ge1xyXG4gICAgICAgICAgICBwYWRkaW5nOiAyMHB4IDtcclxuICAgICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIGB9PC9zdHlsZT5cclxuICAgICAgICA8L2Rpdj5cclxufVxyXG4vLyBnaXRodWLpmZDliLbvvIzmkJzntKLnu5Pmnpzlj6rog73nu5nliY0xMDAw5LiqXHJcblNlYXJjaC5nZXRJbml0aWFsUHJvcHMgPSBhc3luYyAoeyBjdHggfSkgPT4ge1xyXG4gIGNvbnN0IHsgcXVlcnksIHNvcnQsIGxhbmcsIG9yZGVyLCBwYWdlLCBwZXJfcGFnZSB9ID0gY3R4LnF1ZXJ5XHJcblxyXG4gIGlmICghcXVlcnkpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHJlcG9zOiB7XHJcbiAgICAgICAgdG90YWxfY291bnQ6IDBcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8g5ou85o6l6K+35rGC5o6l5Y+j5Y+C5pWwXHJcbiAgLy8g5L6L5a2QOiA/cT1yZWFjdCtsYW5ndWFnZTpyZWFjdCZzb3J0PXN0YXJzJm9yZGVyPWRlc2MmcGFnZT0yXHJcbiAgbGV0IHF1ZXJ5U3RyaW5nID0gYD9xPSR7cXVlcnl9YFxyXG4gIGlmIChsYW5nKSBxdWVyeVN0cmluZyArPSBgK2xhbmd1YWdlOiR7bGFuZ31gXHJcbiAgaWYgKHNvcnQpIHF1ZXJ5U3RyaW5nICs9IGAmc29ydD0ke3NvcnR9Jm9yZGVyPSR7b3JkZXIgfHwgJ2Rlc2MnfWBcclxuICBpZiAocGFnZSkgcXVlcnlTdHJpbmcgKz0gYCZwYWdlPSR7cGFnZX1gXHJcbiAgcXVlcnlTdHJpbmcgKz0gYCZwZXJfcGFnZT0ke3Blcl9wYWdlfWBcclxuXHJcbiAgY29uc3QgcmVzdWx0ID0gYXdhaXQgYXBpLnJlcXVlc3QoXHJcbiAgICB7IHVybDogYC9zZWFyY2gvcmVwb3NpdG9yaWVzJHtxdWVyeVN0cmluZ31gIH0sXHJcbiAgICBjdHgucmVxLFxyXG4gICAgY3R4LnJlc1xyXG4gIClcclxuICAgIGlmKGlzU2VydmVyKXtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICByZXBvczogcmVzdWx0LmRhdGF8fHt9XHJcbiAgICAgIH1cclxuICAgIH1lbHNle1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHJlcG9zOiByZXN1bHQuZGF0YS5kYXRhfHx7fVxyXG4gICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IHdpdGhSb3V0ZXIoU2VhcmNoKSJdfQ== */\\n/*@ sourceURL=C:\\\\Users\\\\marimo\\\\Desktop\\\\next-github\\\\pages\\\\search.js */\"));\n}; // github限制，搜索结果只能给前1000个\n\n\nSearch.getInitialProps =\n/*#__PURE__*/\nfunction () {\n  var _ref4 = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee(_ref3) {\n    var ctx, _ctx$query, query, sort, lang, order, page, per_page, queryString, result;\n\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            ctx = _ref3.ctx;\n            _ctx$query = ctx.query, query = _ctx$query.query, sort = _ctx$query.sort, lang = _ctx$query.lang, order = _ctx$query.order, page = _ctx$query.page, per_page = _ctx$query.per_page;\n\n            if (query) {\n              _context.next = 4;\n              break;\n            }\n\n            return _context.abrupt(\"return\", {\n              repos: {\n                total_count: 0\n              }\n            });\n\n          case 4:\n            // 拼接请求接口参数\n            // 例子: ?q=react+language:react&sort=stars&order=desc&page=2\n            queryString = \"?q=\".concat(query);\n            if (lang) queryString += \"+language:\".concat(lang);\n            if (sort) queryString += \"&sort=\".concat(sort, \"&order=\").concat(order || 'desc');\n            if (page) queryString += \"&page=\".concat(page);\n            queryString += \"&per_page=\".concat(per_page);\n            _context.next = 11;\n            return api.request({\n              url: \"/search/repositories\".concat(queryString)\n            }, ctx.req, ctx.res);\n\n          case 11:\n            result = _context.sent;\n\n            if (!isServer) {\n              _context.next = 16;\n              break;\n            }\n\n            return _context.abrupt(\"return\", {\n              repos: result.data || {}\n            });\n\n          case 16:\n            return _context.abrupt(\"return\", {\n              repos: result.data.data || {}\n            });\n\n          case 17:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function (_x) {\n    return _ref4.apply(this, arguments);\n  };\n}();\n\nexport default withRouter(Search);","map":{"version":3,"sources":["C:\\Users\\marimo\\Desktop\\next-github\\pages\\search.js"],"names":["memo","isValidElement","useEffect","withRouter","Link","api","cacheArray","Repo","LANGUAGE","SORT_TYPE","name","value","order","selectedItemStyle","borderLeft","fontWeight","per_page","FilterLink","query","sort","lang","page","queryString","noop","isServer","Search","router","repos","item","marginBottom","selected","total_count","items","map","repo","id","Number","type","ol","p","getInitialProps","ctx","request","url","req","res","result","data"],"mappings":"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","sourcesContent":["import {memo,isValidElement, useEffect} from 'react'\r\nimport {withRouter} from 'next/router'\r\nimport { Row, Col, List ,Pagination} from 'antd'\r\nimport Link from 'next/link'\r\n\r\nimport api from '../lib/api'\r\nimport { cacheArray } from '../lib/repo-cache'\r\nimport Repo from '../components/Repo'\r\n\r\nconst LANGUAGE = ['JavaScript', 'HTML', 'CSS', 'TypeScript', 'Java', 'Python']\r\nconst SORT_TYPE = [\r\n  {\r\n    name: 'Best Match'\r\n  },\r\n  {\r\n    name: 'Most Stars',\r\n    value: 'stars',\r\n    order: 'desc' // 降序\r\n  },\r\n  {\r\n    name: 'Fewest Stars',\r\n    value: 'stars',\r\n    order: 'asc'\r\n  },\r\n  {\r\n    name: 'Most Forks',\r\n    value: 'forks',\r\n    order: 'desc'\r\n  },\r\n  {\r\n    name: 'Fewest Forks',\r\n    value: 'forks',\r\n    order: 'asc'\r\n  }\r\n]\r\nconst selectedItemStyle = {\r\n  borderLeft: '2px solid #e36209',\r\n  fontWeight: 'bold'\r\n}\r\nconst per_page=20\r\nconst FilterLink=memo(({query, sort, lang, order, page, per_page,name})=>{\r\n  let queryString = `?query=${query}`\r\n  if (lang) queryString += `+language:${lang}`\r\n  if (sort) queryString += `&sort=${sort}&order=${order || 'desc'}`\r\n  if (page) queryString += `&page=${page}`\r\n  queryString += `&per_page=${per_page}`\r\n  return <Link href={queryString}>\r\n    {isValidElement(name)?name:<a>{name}</a>}\r\n  </Link>\r\n})\r\n\r\nfunction noop() {}\r\nconst isServer = typeof window === 'undefined'\r\n\r\nconst Search=({router, repos})=>{\r\n  useEffect(()=>{\r\n    !isServer&&cacheArray(repos.item)\r\n  })\r\n  const query = router.query\r\n  const { lang, sort, order, page } = router.query\r\n  return <div className=\"root\">\r\n        <Row gutter={20}>\r\n          <Col span={6}>\r\n            <List\r\n              bordered\r\n              header={<span className=\"list-header\">语言</span>}\r\n              style={{ marginBottom: 20 }}\r\n              dataSource={LANGUAGE}\r\n              renderItem={item => {\r\n                const selected = lang === item\r\n                return (\r\n                  <List.Item style={selected ? selectedItemStyle : null}>\r\n                      {selected ? (\r\n                    <span>{item}</span>\r\n                  ) : (\r\n                    <FilterLink {...query} name={item} lang={item} />\r\n                  )}\r\n                  </List.Item>\r\n                )\r\n              }}\r\n            ></List>\r\n            <List\r\n              bordered\r\n              header={<span className=\"list-header\">排序</span>}\r\n              dataSource={SORT_TYPE}\r\n              renderItem={item => {\r\n                let selected = false\r\n                if (item.name === 'Best Match' && !sort) {\r\n                  selected = true\r\n                } else if (item.value === sort && item.order === order) {\r\n                  selected = true\r\n                }\r\n                return (\r\n                  <List.Item style={selected ? selectedItemStyle : null}>\r\n                    {selected ? (\r\n                    <span>{item.name}</span>\r\n                  ) : (\r\n                    <FilterLink\r\n                      {...query}\r\n                      name={item.name}\r\n                      sort={item.value}\r\n                      order={item.order}\r\n                    />\r\n                  )}\r\n                  </List.Item>\r\n                )\r\n              }}\r\n            >\r\n            </List>\r\n          </Col>\r\n          <Col span={18}>\r\n          <h2 className=\"repos-title\">{repos.total_count} 个仓库</h2>\r\n          {repos.items\r\n          ?repos.items.map(repo => (\r\n            <Repo repo={repo} key={repo.id} />\r\n          ))\r\n          :'暂无相关仓库'\r\n        }\r\n          <div className=\"pagination\">\r\n            <Pagination\r\n              pageSize={per_page}\r\n              current={Number(page) || 1}\r\n              total={repos.total_count>1000?1000:repos.total_count}\r\n              onChange={noop}\r\n              itemRender={(page, type, ol) => {\r\n                const p = type === 'page'? page: (type === 'prev' ? page -1 : page +1)\r\n                const name = type === 'page' ? page : ol\r\n                return <FilterLink {...query} page={p} name={name}/>\r\n              }}\r\n            />\r\n          </div>\r\n        </Col>\r\n        </Row>\r\n        <style jsx>{`\r\n          .root {\r\n            padding: 20px 0;\r\n          }\r\n          .list-header {\r\n            font-weight: 800;\r\n            font-size: 16px;\r\n          }\r\n          .repos-title {\r\n            border-bottom: 1px solid #eee;\r\n            font-size: 24px;\r\n            line-height: 50px;\r\n          }\r\n          .pagination {\r\n            padding: 20px ;\r\n            text-align: center;\r\n          }\r\n        `}</style>\r\n        </div>\r\n}\r\n// github限制，搜索结果只能给前1000个\r\nSearch.getInitialProps = async ({ ctx }) => {\r\n  const { query, sort, lang, order, page, per_page } = ctx.query\r\n\r\n  if (!query) {\r\n    return {\r\n      repos: {\r\n        total_count: 0\r\n      }\r\n    }\r\n  }\r\n\r\n  // 拼接请求接口参数\r\n  // 例子: ?q=react+language:react&sort=stars&order=desc&page=2\r\n  let queryString = `?q=${query}`\r\n  if (lang) queryString += `+language:${lang}`\r\n  if (sort) queryString += `&sort=${sort}&order=${order || 'desc'}`\r\n  if (page) queryString += `&page=${page}`\r\n  queryString += `&per_page=${per_page}`\r\n\r\n  const result = await api.request(\r\n    { url: `/search/repositories${queryString}` },\r\n    ctx.req,\r\n    ctx.res\r\n  )\r\n    if(isServer){\r\n      return {\r\n        repos: result.data||{}\r\n      }\r\n    }else{\r\n      return {\r\n        repos: result.data.data||{}\r\n      }\r\n    }\r\n}\r\n\r\nexport default withRouter(Search)"]},"metadata":{},"sourceType":"module"}