{"ast":null,"code":"import _Row from \"antd/lib/row\";\nimport _Pagination from \"antd/lib/pagination\";\nimport _Col from \"antd/lib/col\";\nimport _List from \"antd/lib/list\";\nimport _extends from \"@babel/runtime-corejs2/helpers/esm/extends\";\nimport _JSXStyle from \"styled-jsx/style\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { memo, isValidElement, useEffect } from 'react';\nimport { withRouter } from 'next/router';\nimport Link from 'next/link';\nimport api from '../lib/api';\nimport { cacheArray } from '../lib/repo-cache';\nimport Repo from '../components/Repo';\nconst LANGUAGE = ['JavaScript', 'HTML', 'CSS', 'TypeScript', 'Java', 'Python'];\nconst SORT_TYPE = [{\n  name: 'Best Match'\n}, {\n  name: 'Most Stars',\n  value: 'stars',\n  order: 'desc' // 降序\n\n}, {\n  name: 'Fewest Stars',\n  value: 'stars',\n  order: 'asc'\n}, {\n  name: 'Most Forks',\n  value: 'forks',\n  order: 'desc'\n}, {\n  name: 'Fewest Forks',\n  value: 'forks',\n  order: 'asc'\n}];\nconst selectedItemStyle = {\n  borderLeft: '2px solid #e36209',\n  fontWeight: 'bold'\n};\nconst per_page = 20;\nconst FilterLink = memo(({\n  query,\n  sort,\n  lang,\n  order,\n  page,\n  per_page,\n  name\n}) => {\n  let queryString = `?query=${query}`;\n  if (lang) queryString += `+language:${lang}`;\n  if (sort) queryString += `&sort=${sort}&order=${order || 'desc'}`;\n  if (page) queryString += `&page=${page}`;\n  queryString += `&per_page=${per_page}`;\n  return __jsx(Link, {\n    href: queryString\n  }, isValidElement(name) ? name : __jsx(\"a\", null, name));\n});\n\nfunction noop() {}\n\nconst isServer = true;\n\nconst Search = ({\n  router,\n  repos\n}) => {\n  useEffect(() => {\n    !isServer && cacheArray(repos.item);\n  });\n  const query = router.query;\n  const {\n    lang,\n    sort,\n    order,\n    page\n  } = router.query;\n  return __jsx(\"div\", {\n    className: \"jsx-2550782761\" + \" \" + \"root\"\n  }, __jsx(_Row, {\n    gutter: 20\n  }, __jsx(_Col, {\n    span: 6\n  }, __jsx(_List, {\n    bordered: true,\n    header: __jsx(\"span\", {\n      className: \"jsx-2550782761\" + \" \" + \"list-header\"\n    }, \"\\u8BED\\u8A00\"),\n    style: {\n      marginBottom: 20\n    },\n    dataSource: LANGUAGE,\n    renderItem: item => {\n      const selected = lang === item;\n      return __jsx(_List.Item, {\n        style: selected ? selectedItemStyle : null\n      }, selected ? __jsx(\"span\", {\n        className: \"jsx-2550782761\"\n      }, item) : __jsx(FilterLink, _extends({}, query, {\n        name: item,\n        lang: item\n      })));\n    }\n  }), __jsx(_List, {\n    bordered: true,\n    header: __jsx(\"span\", {\n      className: \"jsx-2550782761\" + \" \" + \"list-header\"\n    }, \"\\u6392\\u5E8F\"),\n    dataSource: SORT_TYPE,\n    renderItem: item => {\n      let selected = false;\n\n      if (item.name === 'Best Match' && !sort) {\n        selected = true;\n      } else if (item.value === sort && item.order === order) {\n        selected = true;\n      }\n\n      return __jsx(_List.Item, {\n        style: selected ? selectedItemStyle : null\n      }, selected ? __jsx(\"span\", {\n        className: \"jsx-2550782761\"\n      }, item.name) : __jsx(FilterLink, _extends({}, query, {\n        name: item.name,\n        sort: item.value,\n        order: item.order\n      })));\n    }\n  })), __jsx(_Col, {\n    span: 18\n  }, __jsx(\"h2\", {\n    className: \"jsx-2550782761\" + \" \" + \"repos-title\"\n  }, repos.total_count, \" \\u4E2A\\u4ED3\\u5E93\"), repos.items ? repos.items.map(repo => __jsx(Repo, {\n    repo: repo,\n    key: repo.id\n  })) : '暂无相关仓库', __jsx(\"div\", {\n    className: \"jsx-2550782761\" + \" \" + \"pagination\"\n  }, __jsx(_Pagination, {\n    pageSize: per_page,\n    current: Number(page) || 1,\n    total: repos.total_count > 1000 ? 1000 : repos.total_count,\n    onChange: noop,\n    itemRender: (page, type, ol) => {\n      const p = type === 'page' ? page : type === 'prev' ? page - 1 : page + 1;\n      const name = type === 'page' ? page : ol;\n      return __jsx(FilterLink, _extends({}, query, {\n        page: p,\n        name: name\n      }));\n    }\n  })))), __jsx(_JSXStyle, {\n    id: \"2550782761\"\n  }, \".root.jsx-2550782761{padding:20px 0;}.list-header.jsx-2550782761{font-weight:800;font-size:16px;}.repos-title.jsx-2550782761{border-bottom:1px solid #eee;font-size:24px;line-height:50px;}.pagination.jsx-2550782761{padding:20px;text-align:center;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbWFyaW1vXFxEZXNrdG9wXFxuZXh0LWdpdGh1YlxccGFnZXNcXHNlYXJjaC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFxSW9CLEFBRzRCLEFBR0MsQUFJYSxBQUtmLGFBQ0ksRUFacEIsQ0FHaUIsYUFJQSxFQUhqQixBQVNBLGFBTG1CLGlCQUNuQiIsImZpbGUiOiJDOlxcVXNlcnNcXG1hcmltb1xcRGVza3RvcFxcbmV4dC1naXRodWJcXHBhZ2VzXFxzZWFyY2guanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge21lbW8saXNWYWxpZEVsZW1lbnQsIHVzZUVmZmVjdH0gZnJvbSAncmVhY3QnXHJcbmltcG9ydCB7d2l0aFJvdXRlcn0gZnJvbSAnbmV4dC9yb3V0ZXInXHJcbmltcG9ydCB7IFJvdywgQ29sLCBMaXN0ICxQYWdpbmF0aW9ufSBmcm9tICdhbnRkJ1xyXG5pbXBvcnQgTGluayBmcm9tICduZXh0L2xpbmsnXHJcblxyXG5pbXBvcnQgYXBpIGZyb20gJy4uL2xpYi9hcGknXHJcbmltcG9ydCB7IGNhY2hlQXJyYXkgfSBmcm9tICcuLi9saWIvcmVwby1jYWNoZSdcclxuaW1wb3J0IFJlcG8gZnJvbSAnLi4vY29tcG9uZW50cy9SZXBvJ1xyXG5cclxuY29uc3QgTEFOR1VBR0UgPSBbJ0phdmFTY3JpcHQnLCAnSFRNTCcsICdDU1MnLCAnVHlwZVNjcmlwdCcsICdKYXZhJywgJ1B5dGhvbiddXHJcbmNvbnN0IFNPUlRfVFlQRSA9IFtcclxuICB7XHJcbiAgICBuYW1lOiAnQmVzdCBNYXRjaCdcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6ICdNb3N0IFN0YXJzJyxcclxuICAgIHZhbHVlOiAnc3RhcnMnLFxyXG4gICAgb3JkZXI6ICdkZXNjJyAvLyDpmY3luo9cclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6ICdGZXdlc3QgU3RhcnMnLFxyXG4gICAgdmFsdWU6ICdzdGFycycsXHJcbiAgICBvcmRlcjogJ2FzYydcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6ICdNb3N0IEZvcmtzJyxcclxuICAgIHZhbHVlOiAnZm9ya3MnLFxyXG4gICAgb3JkZXI6ICdkZXNjJ1xyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogJ0Zld2VzdCBGb3JrcycsXHJcbiAgICB2YWx1ZTogJ2ZvcmtzJyxcclxuICAgIG9yZGVyOiAnYXNjJ1xyXG4gIH1cclxuXVxyXG5jb25zdCBzZWxlY3RlZEl0ZW1TdHlsZSA9IHtcclxuICBib3JkZXJMZWZ0OiAnMnB4IHNvbGlkICNlMzYyMDknLFxyXG4gIGZvbnRXZWlnaHQ6ICdib2xkJ1xyXG59XHJcbmNvbnN0IHBlcl9wYWdlPTIwXHJcbmNvbnN0IEZpbHRlckxpbms9bWVtbygoe3F1ZXJ5LCBzb3J0LCBsYW5nLCBvcmRlciwgcGFnZSwgcGVyX3BhZ2UsbmFtZX0pPT57XHJcbiAgbGV0IHF1ZXJ5U3RyaW5nID0gYD9xdWVyeT0ke3F1ZXJ5fWBcclxuICBpZiAobGFuZykgcXVlcnlTdHJpbmcgKz0gYCtsYW5ndWFnZToke2xhbmd9YFxyXG4gIGlmIChzb3J0KSBxdWVyeVN0cmluZyArPSBgJnNvcnQ9JHtzb3J0fSZvcmRlcj0ke29yZGVyIHx8ICdkZXNjJ31gXHJcbiAgaWYgKHBhZ2UpIHF1ZXJ5U3RyaW5nICs9IGAmcGFnZT0ke3BhZ2V9YFxyXG4gIHF1ZXJ5U3RyaW5nICs9IGAmcGVyX3BhZ2U9JHtwZXJfcGFnZX1gXHJcbiAgcmV0dXJuIDxMaW5rIGhyZWY9e3F1ZXJ5U3RyaW5nfT5cclxuICAgIHtpc1ZhbGlkRWxlbWVudChuYW1lKT9uYW1lOjxhPntuYW1lfTwvYT59XHJcbiAgPC9MaW5rPlxyXG59KVxyXG5cclxuZnVuY3Rpb24gbm9vcCgpIHt9XHJcbmNvbnN0IGlzU2VydmVyID0gdHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCdcclxuXHJcbmNvbnN0IFNlYXJjaD0oe3JvdXRlciwgcmVwb3N9KT0+e1xyXG4gIHVzZUVmZmVjdCgoKT0+e1xyXG4gICAgIWlzU2VydmVyJiZjYWNoZUFycmF5KHJlcG9zLml0ZW0pXHJcbiAgfSlcclxuICBjb25zdCBxdWVyeSA9IHJvdXRlci5xdWVyeVxyXG4gIGNvbnN0IHsgbGFuZywgc29ydCwgb3JkZXIsIHBhZ2UgfSA9IHJvdXRlci5xdWVyeVxyXG4gIHJldHVybiA8ZGl2IGNsYXNzTmFtZT1cInJvb3RcIj5cclxuICAgICAgICA8Um93IGd1dHRlcj17MjB9PlxyXG4gICAgICAgICAgPENvbCBzcGFuPXs2fT5cclxuICAgICAgICAgICAgPExpc3RcclxuICAgICAgICAgICAgICBib3JkZXJlZFxyXG4gICAgICAgICAgICAgIGhlYWRlcj17PHNwYW4gY2xhc3NOYW1lPVwibGlzdC1oZWFkZXJcIj7or63oqIA8L3NwYW4+fVxyXG4gICAgICAgICAgICAgIHN0eWxlPXt7IG1hcmdpbkJvdHRvbTogMjAgfX1cclxuICAgICAgICAgICAgICBkYXRhU291cmNlPXtMQU5HVUFHRX1cclxuICAgICAgICAgICAgICByZW5kZXJJdGVtPXtpdGVtID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkID0gbGFuZyA9PT0gaXRlbVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgICAgICAgPExpc3QuSXRlbSBzdHlsZT17c2VsZWN0ZWQgPyBzZWxlY3RlZEl0ZW1TdHlsZSA6IG51bGx9PlxyXG4gICAgICAgICAgICAgICAgICAgICAge3NlbGVjdGVkID8gKFxyXG4gICAgICAgICAgICAgICAgICAgIDxzcGFuPntpdGVtfTwvc3Bhbj5cclxuICAgICAgICAgICAgICAgICAgKSA6IChcclxuICAgICAgICAgICAgICAgICAgICA8RmlsdGVyTGluayB7Li4ucXVlcnl9IG5hbWU9e2l0ZW19IGxhbmc9e2l0ZW19IC8+XHJcbiAgICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAgICAgIDwvTGlzdC5JdGVtPlxyXG4gICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgIH19XHJcbiAgICAgICAgICAgID48L0xpc3Q+XHJcbiAgICAgICAgICAgIDxMaXN0XHJcbiAgICAgICAgICAgICAgYm9yZGVyZWRcclxuICAgICAgICAgICAgICBoZWFkZXI9ezxzcGFuIGNsYXNzTmFtZT1cImxpc3QtaGVhZGVyXCI+5o6S5bqPPC9zcGFuPn1cclxuICAgICAgICAgICAgICBkYXRhU291cmNlPXtTT1JUX1RZUEV9XHJcbiAgICAgICAgICAgICAgcmVuZGVySXRlbT17aXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICBsZXQgc2VsZWN0ZWQgPSBmYWxzZVxyXG4gICAgICAgICAgICAgICAgaWYgKGl0ZW0ubmFtZSA9PT0gJ0Jlc3QgTWF0Y2gnICYmICFzb3J0KSB7XHJcbiAgICAgICAgICAgICAgICAgIHNlbGVjdGVkID0gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpdGVtLnZhbHVlID09PSBzb3J0ICYmIGl0ZW0ub3JkZXIgPT09IG9yZGVyKSB7XHJcbiAgICAgICAgICAgICAgICAgIHNlbGVjdGVkID0gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgICAgICAgPExpc3QuSXRlbSBzdHlsZT17c2VsZWN0ZWQgPyBzZWxlY3RlZEl0ZW1TdHlsZSA6IG51bGx9PlxyXG4gICAgICAgICAgICAgICAgICAgIHtzZWxlY3RlZCA/IChcclxuICAgICAgICAgICAgICAgICAgICA8c3Bhbj57aXRlbS5uYW1lfTwvc3Bhbj5cclxuICAgICAgICAgICAgICAgICAgKSA6IChcclxuICAgICAgICAgICAgICAgICAgICA8RmlsdGVyTGlua1xyXG4gICAgICAgICAgICAgICAgICAgICAgey4uLnF1ZXJ5fVxyXG4gICAgICAgICAgICAgICAgICAgICAgbmFtZT17aXRlbS5uYW1lfVxyXG4gICAgICAgICAgICAgICAgICAgICAgc29ydD17aXRlbS52YWx1ZX1cclxuICAgICAgICAgICAgICAgICAgICAgIG9yZGVyPXtpdGVtLm9yZGVyfVxyXG4gICAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAgICAgIDwvTGlzdC5JdGVtPlxyXG4gICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgIH19XHJcbiAgICAgICAgICAgID5cclxuICAgICAgICAgICAgPC9MaXN0PlxyXG4gICAgICAgICAgPC9Db2w+XHJcbiAgICAgICAgICA8Q29sIHNwYW49ezE4fT5cclxuICAgICAgICAgIDxoMiBjbGFzc05hbWU9XCJyZXBvcy10aXRsZVwiPntyZXBvcy50b3RhbF9jb3VudH0g5Liq5LuT5bqTPC9oMj5cclxuICAgICAgICAgIHtyZXBvcy5pdGVtc1xyXG4gICAgICAgICAgP3JlcG9zLml0ZW1zLm1hcChyZXBvID0+IChcclxuICAgICAgICAgICAgPFJlcG8gcmVwbz17cmVwb30ga2V5PXtyZXBvLmlkfSAvPlxyXG4gICAgICAgICAgKSlcclxuICAgICAgICAgIDon5pqC5peg55u45YWz5LuT5bqTJ1xyXG4gICAgICAgIH1cclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicGFnaW5hdGlvblwiPlxyXG4gICAgICAgICAgICA8UGFnaW5hdGlvblxyXG4gICAgICAgICAgICAgIHBhZ2VTaXplPXtwZXJfcGFnZX1cclxuICAgICAgICAgICAgICBjdXJyZW50PXtOdW1iZXIocGFnZSkgfHwgMX1cclxuICAgICAgICAgICAgICB0b3RhbD17cmVwb3MudG90YWxfY291bnQ+MTAwMD8xMDAwOnJlcG9zLnRvdGFsX2NvdW50fVxyXG4gICAgICAgICAgICAgIG9uQ2hhbmdlPXtub29wfVxyXG4gICAgICAgICAgICAgIGl0ZW1SZW5kZXI9eyhwYWdlLCB0eXBlLCBvbCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcCA9IHR5cGUgPT09ICdwYWdlJz8gcGFnZTogKHR5cGUgPT09ICdwcmV2JyA/IHBhZ2UgLTEgOiBwYWdlICsxKVxyXG4gICAgICAgICAgICAgICAgY29uc3QgbmFtZSA9IHR5cGUgPT09ICdwYWdlJyA/IHBhZ2UgOiBvbFxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIDxGaWx0ZXJMaW5rIHsuLi5xdWVyeX0gcGFnZT17cH0gbmFtZT17bmFtZX0vPlxyXG4gICAgICAgICAgICAgIH19XHJcbiAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8L0NvbD5cclxuICAgICAgICA8L1Jvdz5cclxuICAgICAgICA8c3R5bGUganN4PntgXHJcbiAgICAgICAgICAucm9vdCB7XHJcbiAgICAgICAgICAgIHBhZGRpbmc6IDIwcHggMDtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIC5saXN0LWhlYWRlciB7XHJcbiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiA4MDA7XHJcbiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTZweDtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIC5yZXBvcy10aXRsZSB7XHJcbiAgICAgICAgICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjZWVlO1xyXG4gICAgICAgICAgICBmb250LXNpemU6IDI0cHg7XHJcbiAgICAgICAgICAgIGxpbmUtaGVpZ2h0OiA1MHB4O1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgLnBhZ2luYXRpb24ge1xyXG4gICAgICAgICAgICBwYWRkaW5nOiAyMHB4IDtcclxuICAgICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIGB9PC9zdHlsZT5cclxuICAgICAgICA8L2Rpdj5cclxufVxyXG4vLyBnaXRodWLpmZDliLbvvIzmkJzntKLnu5Pmnpzlj6rog73nu5nliY0xMDAw5LiqXHJcblNlYXJjaC5nZXRJbml0aWFsUHJvcHMgPSBhc3luYyAoeyBjdHggfSkgPT4ge1xyXG4gIGNvbnN0IHsgcXVlcnksIHNvcnQsIGxhbmcsIG9yZGVyLCBwYWdlLCBwZXJfcGFnZSB9ID0gY3R4LnF1ZXJ5XHJcblxyXG4gIGlmICghcXVlcnkpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHJlcG9zOiB7XHJcbiAgICAgICAgdG90YWxfY291bnQ6IDBcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8g5ou85o6l6K+35rGC5o6l5Y+j5Y+C5pWwXHJcbiAgLy8g5L6L5a2QOiA/cT1yZWFjdCtsYW5ndWFnZTpyZWFjdCZzb3J0PXN0YXJzJm9yZGVyPWRlc2MmcGFnZT0yXHJcbiAgbGV0IHF1ZXJ5U3RyaW5nID0gYD9xPSR7cXVlcnl9YFxyXG4gIGlmIChsYW5nKSBxdWVyeVN0cmluZyArPSBgK2xhbmd1YWdlOiR7bGFuZ31gXHJcbiAgaWYgKHNvcnQpIHF1ZXJ5U3RyaW5nICs9IGAmc29ydD0ke3NvcnR9Jm9yZGVyPSR7b3JkZXIgfHwgJ2Rlc2MnfWBcclxuICBpZiAocGFnZSkgcXVlcnlTdHJpbmcgKz0gYCZwYWdlPSR7cGFnZX1gXHJcbiAgcXVlcnlTdHJpbmcgKz0gYCZwZXJfcGFnZT0ke3Blcl9wYWdlfWBcclxuXHJcbiAgY29uc3QgcmVzdWx0ID0gYXdhaXQgYXBpLnJlcXVlc3QoXHJcbiAgICB7IHVybDogYC9zZWFyY2gvcmVwb3NpdG9yaWVzJHtxdWVyeVN0cmluZ31gIH0sXHJcbiAgICBjdHgucmVxLFxyXG4gICAgY3R4LnJlc1xyXG4gIClcclxuICAgIGlmKGlzU2VydmVyKXtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICByZXBvczogcmVzdWx0LmRhdGF8fHt9XHJcbiAgICAgIH1cclxuICAgIH1lbHNle1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHJlcG9zOiByZXN1bHQuZGF0YS5kYXRhfHx7fVxyXG4gICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IHdpdGhSb3V0ZXIoU2VhcmNoKSJdfQ== */\\n/*@ sourceURL=C:\\\\Users\\\\marimo\\\\Desktop\\\\next-github\\\\pages\\\\search.js */\"));\n}; // github限制，搜索结果只能给前1000个\n\n\nSearch.getInitialProps = async ({\n  ctx\n}) => {\n  const {\n    query,\n    sort,\n    lang,\n    order,\n    page,\n    per_page\n  } = ctx.query;\n\n  if (!query) {\n    return {\n      repos: {\n        total_count: 0\n      }\n    };\n  } // 拼接请求接口参数\n  // 例子: ?q=react+language:react&sort=stars&order=desc&page=2\n\n\n  let queryString = `?q=${query}`;\n  if (lang) queryString += `+language:${lang}`;\n  if (sort) queryString += `&sort=${sort}&order=${order || 'desc'}`;\n  if (page) queryString += `&page=${page}`;\n  queryString += `&per_page=${per_page}`;\n  const result = await api.request({\n    url: `/search/repositories${queryString}`\n  }, ctx.req, ctx.res);\n\n  if (isServer) {\n    return {\n      repos: result.data || {}\n    };\n  } else {\n    return {\n      repos: result.data.data || {}\n    };\n  }\n};\n\nexport default withRouter(Search);","map":{"version":3,"sources":["C:\\Users\\marimo\\Desktop\\next-github\\pages\\search.js"],"names":["memo","isValidElement","useEffect","withRouter","Link","api","cacheArray","Repo","LANGUAGE","SORT_TYPE","name","value","order","selectedItemStyle","borderLeft","fontWeight","per_page","FilterLink","query","sort","lang","page","queryString","noop","isServer","Search","router","repos","item","marginBottom","selected","total_count","items","map","repo","id","Number","type","ol","p","getInitialProps","ctx","result","request","url","req","res","data"],"mappings":";;;;;;;;AAAA,SAAQA,IAAR,EAAaC,cAAb,EAA6BC,SAA7B,QAA6C,OAA7C;AACA,SAAQC,UAAR,QAAyB,aAAzB;AAEA,OAAOC,IAAP,MAAiB,WAAjB;AAEA,OAAOC,GAAP,MAAgB,YAAhB;AACA,SAASC,UAAT,QAA2B,mBAA3B;AACA,OAAOC,IAAP,MAAiB,oBAAjB;AAEA,MAAMC,QAAQ,GAAG,CAAC,YAAD,EAAe,MAAf,EAAuB,KAAvB,EAA8B,YAA9B,EAA4C,MAA5C,EAAoD,QAApD,CAAjB;AACA,MAAMC,SAAS,GAAG,CAChB;AACEC,EAAAA,IAAI,EAAE;AADR,CADgB,EAIhB;AACEA,EAAAA,IAAI,EAAE,YADR;AAEEC,EAAAA,KAAK,EAAE,OAFT;AAGEC,EAAAA,KAAK,EAAE,MAHT,CAGgB;;AAHhB,CAJgB,EAShB;AACEF,EAAAA,IAAI,EAAE,cADR;AAEEC,EAAAA,KAAK,EAAE,OAFT;AAGEC,EAAAA,KAAK,EAAE;AAHT,CATgB,EAchB;AACEF,EAAAA,IAAI,EAAE,YADR;AAEEC,EAAAA,KAAK,EAAE,OAFT;AAGEC,EAAAA,KAAK,EAAE;AAHT,CAdgB,EAmBhB;AACEF,EAAAA,IAAI,EAAE,cADR;AAEEC,EAAAA,KAAK,EAAE,OAFT;AAGEC,EAAAA,KAAK,EAAE;AAHT,CAnBgB,CAAlB;AAyBA,MAAMC,iBAAiB,GAAG;AACxBC,EAAAA,UAAU,EAAE,mBADY;AAExBC,EAAAA,UAAU,EAAE;AAFY,CAA1B;AAIA,MAAMC,QAAQ,GAAC,EAAf;AACA,MAAMC,UAAU,GAACjB,IAAI,CAAC,CAAC;AAACkB,EAAAA,KAAD;AAAQC,EAAAA,IAAR;AAAcC,EAAAA,IAAd;AAAoBR,EAAAA,KAApB;AAA2BS,EAAAA,IAA3B;AAAiCL,EAAAA,QAAjC;AAA0CN,EAAAA;AAA1C,CAAD,KAAmD;AACvE,MAAIY,WAAW,GAAI,UAASJ,KAAM,EAAlC;AACA,MAAIE,IAAJ,EAAUE,WAAW,IAAK,aAAYF,IAAK,EAAjC;AACV,MAAID,IAAJ,EAAUG,WAAW,IAAK,SAAQH,IAAK,UAASP,KAAK,IAAI,MAAO,EAAtD;AACV,MAAIS,IAAJ,EAAUC,WAAW,IAAK,SAAQD,IAAK,EAA7B;AACVC,EAAAA,WAAW,IAAK,aAAYN,QAAS,EAArC;AACA,SAAO,MAAC,IAAD;AAAM,IAAA,IAAI,EAAEM;AAAZ,KACJrB,cAAc,CAACS,IAAD,CAAd,GAAqBA,IAArB,GAA0B,iBAAIA,IAAJ,CADtB,CAAP;AAGD,CAToB,CAArB;;AAWA,SAASa,IAAT,GAAgB,CAAE;;AAClB,MAAMC,QAAQ,OAAd;;AAEA,MAAMC,MAAM,GAAC,CAAC;AAACC,EAAAA,MAAD;AAASC,EAAAA;AAAT,CAAD,KAAmB;AAC9BzB,EAAAA,SAAS,CAAC,MAAI;AACZ,KAACsB,QAAD,IAAWlB,UAAU,CAACqB,KAAK,CAACC,IAAP,CAArB;AACD,GAFQ,CAAT;AAGA,QAAMV,KAAK,GAAGQ,MAAM,CAACR,KAArB;AACA,QAAM;AAAEE,IAAAA,IAAF;AAAQD,IAAAA,IAAR;AAAcP,IAAAA,KAAd;AAAqBS,IAAAA;AAArB,MAA8BK,MAAM,CAACR,KAA3C;AACA,SAAO;AAAA,wCAAe;AAAf,KACD;AAAK,IAAA,MAAM,EAAE;AAAb,KACE;AAAK,IAAA,IAAI,EAAE;AAAX,KACE;AACE,IAAA,QAAQ,MADV;AAEE,IAAA,MAAM,EAAE;AAAA,0CAAgB;AAAhB,sBAFV;AAGE,IAAA,KAAK,EAAE;AAAEW,MAAAA,YAAY,EAAE;AAAhB,KAHT;AAIE,IAAA,UAAU,EAAErB,QAJd;AAKE,IAAA,UAAU,EAAEoB,IAAI,IAAI;AAClB,YAAME,QAAQ,GAAGV,IAAI,KAAKQ,IAA1B;AACA,aACE,YAAM,IAAN;AAAW,QAAA,KAAK,EAAEE,QAAQ,GAAGjB,iBAAH,GAAuB;AAAjD,SACKiB,QAAQ,GACX;AAAA;AAAA,SAAOF,IAAP,CADW,GAGX,MAAC,UAAD,eAAgBV,KAAhB;AAAuB,QAAA,IAAI,EAAEU,IAA7B;AAAmC,QAAA,IAAI,EAAEA;AAAzC,SAJF,CADF;AASD;AAhBH,IADF,EAmBE;AACE,IAAA,QAAQ,MADV;AAEE,IAAA,MAAM,EAAE;AAAA,0CAAgB;AAAhB,sBAFV;AAGE,IAAA,UAAU,EAAEnB,SAHd;AAIE,IAAA,UAAU,EAAEmB,IAAI,IAAI;AAClB,UAAIE,QAAQ,GAAG,KAAf;;AACA,UAAIF,IAAI,CAAClB,IAAL,KAAc,YAAd,IAA8B,CAACS,IAAnC,EAAyC;AACvCW,QAAAA,QAAQ,GAAG,IAAX;AACD,OAFD,MAEO,IAAIF,IAAI,CAACjB,KAAL,KAAeQ,IAAf,IAAuBS,IAAI,CAAChB,KAAL,KAAeA,KAA1C,EAAiD;AACtDkB,QAAAA,QAAQ,GAAG,IAAX;AACD;;AACD,aACE,YAAM,IAAN;AAAW,QAAA,KAAK,EAAEA,QAAQ,GAAGjB,iBAAH,GAAuB;AAAjD,SACGiB,QAAQ,GACT;AAAA;AAAA,SAAOF,IAAI,CAAClB,IAAZ,CADS,GAGT,MAAC,UAAD,eACMQ,KADN;AAEE,QAAA,IAAI,EAAEU,IAAI,CAAClB,IAFb;AAGE,QAAA,IAAI,EAAEkB,IAAI,CAACjB,KAHb;AAIE,QAAA,KAAK,EAAEiB,IAAI,CAAChB;AAJd,SAJF,CADF;AAcD;AAzBH,IAnBF,CADF,EAiDE;AAAK,IAAA,IAAI,EAAE;AAAX,KACA;AAAA,wCAAc;AAAd,KAA6Be,KAAK,CAACI,WAAnC,wBADA,EAECJ,KAAK,CAACK,KAAN,GACAL,KAAK,CAACK,KAAN,CAAYC,GAAZ,CAAgBC,IAAI,IACnB,MAAC,IAAD;AAAM,IAAA,IAAI,EAAEA,IAAZ;AAAkB,IAAA,GAAG,EAAEA,IAAI,CAACC;AAA5B,IADD,CADA,GAIA,QAND,EAQA;AAAA,wCAAe;AAAf,KACE;AACE,IAAA,QAAQ,EAAEnB,QADZ;AAEE,IAAA,OAAO,EAAEoB,MAAM,CAACf,IAAD,CAAN,IAAgB,CAF3B;AAGE,IAAA,KAAK,EAAEM,KAAK,CAACI,WAAN,GAAkB,IAAlB,GAAuB,IAAvB,GAA4BJ,KAAK,CAACI,WAH3C;AAIE,IAAA,QAAQ,EAAER,IAJZ;AAKE,IAAA,UAAU,EAAE,CAACF,IAAD,EAAOgB,IAAP,EAAaC,EAAb,KAAoB;AAC9B,YAAMC,CAAC,GAAGF,IAAI,KAAK,MAAT,GAAiBhB,IAAjB,GAAwBgB,IAAI,KAAK,MAAT,GAAkBhB,IAAI,GAAE,CAAxB,GAA4BA,IAAI,GAAE,CAApE;AACA,YAAMX,IAAI,GAAG2B,IAAI,KAAK,MAAT,GAAkBhB,IAAlB,GAAyBiB,EAAtC;AACA,aAAO,MAAC,UAAD,eAAgBpB,KAAhB;AAAuB,QAAA,IAAI,EAAEqB,CAA7B;AAAgC,QAAA,IAAI,EAAE7B;AAAtC,SAAP;AACD;AATH,IADF,CARA,CAjDF,CADC;AAAA;AAAA,w9QAAP;AA4FD,CAlGD,C,CAmGA;;;AACAe,MAAM,CAACe,eAAP,GAAyB,OAAO;AAAEC,EAAAA;AAAF,CAAP,KAAmB;AAC1C,QAAM;AAAEvB,IAAAA,KAAF;AAASC,IAAAA,IAAT;AAAeC,IAAAA,IAAf;AAAqBR,IAAAA,KAArB;AAA4BS,IAAAA,IAA5B;AAAkCL,IAAAA;AAAlC,MAA+CyB,GAAG,CAACvB,KAAzD;;AAEA,MAAI,CAACA,KAAL,EAAY;AACV,WAAO;AACLS,MAAAA,KAAK,EAAE;AACLI,QAAAA,WAAW,EAAE;AADR;AADF,KAAP;AAKD,GATyC,CAW1C;AACA;;;AACA,MAAIT,WAAW,GAAI,MAAKJ,KAAM,EAA9B;AACA,MAAIE,IAAJ,EAAUE,WAAW,IAAK,aAAYF,IAAK,EAAjC;AACV,MAAID,IAAJ,EAAUG,WAAW,IAAK,SAAQH,IAAK,UAASP,KAAK,IAAI,MAAO,EAAtD;AACV,MAAIS,IAAJ,EAAUC,WAAW,IAAK,SAAQD,IAAK,EAA7B;AACVC,EAAAA,WAAW,IAAK,aAAYN,QAAS,EAArC;AAEA,QAAM0B,MAAM,GAAG,MAAMrC,GAAG,CAACsC,OAAJ,CACnB;AAAEC,IAAAA,GAAG,EAAG,uBAAsBtB,WAAY;AAA1C,GADmB,EAEnBmB,GAAG,CAACI,GAFe,EAGnBJ,GAAG,CAACK,GAHe,CAArB;;AAKE,MAAGtB,QAAH,EAAY;AACV,WAAO;AACLG,MAAAA,KAAK,EAAEe,MAAM,CAACK,IAAP,IAAa;AADf,KAAP;AAGD,GAJD,MAIK;AACH,WAAO;AACLpB,MAAAA,KAAK,EAAEe,MAAM,CAACK,IAAP,CAAYA,IAAZ,IAAkB;AADpB,KAAP;AAGD;AACJ,CAjCD;;AAmCA,eAAe5C,UAAU,CAACsB,MAAD,CAAzB","sourcesContent":["import {memo,isValidElement, useEffect} from 'react'\r\nimport {withRouter} from 'next/router'\r\nimport { Row, Col, List ,Pagination} from 'antd'\r\nimport Link from 'next/link'\r\n\r\nimport api from '../lib/api'\r\nimport { cacheArray } from '../lib/repo-cache'\r\nimport Repo from '../components/Repo'\r\n\r\nconst LANGUAGE = ['JavaScript', 'HTML', 'CSS', 'TypeScript', 'Java', 'Python']\r\nconst SORT_TYPE = [\r\n  {\r\n    name: 'Best Match'\r\n  },\r\n  {\r\n    name: 'Most Stars',\r\n    value: 'stars',\r\n    order: 'desc' // 降序\r\n  },\r\n  {\r\n    name: 'Fewest Stars',\r\n    value: 'stars',\r\n    order: 'asc'\r\n  },\r\n  {\r\n    name: 'Most Forks',\r\n    value: 'forks',\r\n    order: 'desc'\r\n  },\r\n  {\r\n    name: 'Fewest Forks',\r\n    value: 'forks',\r\n    order: 'asc'\r\n  }\r\n]\r\nconst selectedItemStyle = {\r\n  borderLeft: '2px solid #e36209',\r\n  fontWeight: 'bold'\r\n}\r\nconst per_page=20\r\nconst FilterLink=memo(({query, sort, lang, order, page, per_page,name})=>{\r\n  let queryString = `?query=${query}`\r\n  if (lang) queryString += `+language:${lang}`\r\n  if (sort) queryString += `&sort=${sort}&order=${order || 'desc'}`\r\n  if (page) queryString += `&page=${page}`\r\n  queryString += `&per_page=${per_page}`\r\n  return <Link href={queryString}>\r\n    {isValidElement(name)?name:<a>{name}</a>}\r\n  </Link>\r\n})\r\n\r\nfunction noop() {}\r\nconst isServer = typeof window === 'undefined'\r\n\r\nconst Search=({router, repos})=>{\r\n  useEffect(()=>{\r\n    !isServer&&cacheArray(repos.item)\r\n  })\r\n  const query = router.query\r\n  const { lang, sort, order, page } = router.query\r\n  return <div className=\"root\">\r\n        <Row gutter={20}>\r\n          <Col span={6}>\r\n            <List\r\n              bordered\r\n              header={<span className=\"list-header\">语言</span>}\r\n              style={{ marginBottom: 20 }}\r\n              dataSource={LANGUAGE}\r\n              renderItem={item => {\r\n                const selected = lang === item\r\n                return (\r\n                  <List.Item style={selected ? selectedItemStyle : null}>\r\n                      {selected ? (\r\n                    <span>{item}</span>\r\n                  ) : (\r\n                    <FilterLink {...query} name={item} lang={item} />\r\n                  )}\r\n                  </List.Item>\r\n                )\r\n              }}\r\n            ></List>\r\n            <List\r\n              bordered\r\n              header={<span className=\"list-header\">排序</span>}\r\n              dataSource={SORT_TYPE}\r\n              renderItem={item => {\r\n                let selected = false\r\n                if (item.name === 'Best Match' && !sort) {\r\n                  selected = true\r\n                } else if (item.value === sort && item.order === order) {\r\n                  selected = true\r\n                }\r\n                return (\r\n                  <List.Item style={selected ? selectedItemStyle : null}>\r\n                    {selected ? (\r\n                    <span>{item.name}</span>\r\n                  ) : (\r\n                    <FilterLink\r\n                      {...query}\r\n                      name={item.name}\r\n                      sort={item.value}\r\n                      order={item.order}\r\n                    />\r\n                  )}\r\n                  </List.Item>\r\n                )\r\n              }}\r\n            >\r\n            </List>\r\n          </Col>\r\n          <Col span={18}>\r\n          <h2 className=\"repos-title\">{repos.total_count} 个仓库</h2>\r\n          {repos.items\r\n          ?repos.items.map(repo => (\r\n            <Repo repo={repo} key={repo.id} />\r\n          ))\r\n          :'暂无相关仓库'\r\n        }\r\n          <div className=\"pagination\">\r\n            <Pagination\r\n              pageSize={per_page}\r\n              current={Number(page) || 1}\r\n              total={repos.total_count>1000?1000:repos.total_count}\r\n              onChange={noop}\r\n              itemRender={(page, type, ol) => {\r\n                const p = type === 'page'? page: (type === 'prev' ? page -1 : page +1)\r\n                const name = type === 'page' ? page : ol\r\n                return <FilterLink {...query} page={p} name={name}/>\r\n              }}\r\n            />\r\n          </div>\r\n        </Col>\r\n        </Row>\r\n        <style jsx>{`\r\n          .root {\r\n            padding: 20px 0;\r\n          }\r\n          .list-header {\r\n            font-weight: 800;\r\n            font-size: 16px;\r\n          }\r\n          .repos-title {\r\n            border-bottom: 1px solid #eee;\r\n            font-size: 24px;\r\n            line-height: 50px;\r\n          }\r\n          .pagination {\r\n            padding: 20px ;\r\n            text-align: center;\r\n          }\r\n        `}</style>\r\n        </div>\r\n}\r\n// github限制，搜索结果只能给前1000个\r\nSearch.getInitialProps = async ({ ctx }) => {\r\n  const { query, sort, lang, order, page, per_page } = ctx.query\r\n\r\n  if (!query) {\r\n    return {\r\n      repos: {\r\n        total_count: 0\r\n      }\r\n    }\r\n  }\r\n\r\n  // 拼接请求接口参数\r\n  // 例子: ?q=react+language:react&sort=stars&order=desc&page=2\r\n  let queryString = `?q=${query}`\r\n  if (lang) queryString += `+language:${lang}`\r\n  if (sort) queryString += `&sort=${sort}&order=${order || 'desc'}`\r\n  if (page) queryString += `&page=${page}`\r\n  queryString += `&per_page=${per_page}`\r\n\r\n  const result = await api.request(\r\n    { url: `/search/repositories${queryString}` },\r\n    ctx.req,\r\n    ctx.res\r\n  )\r\n    if(isServer){\r\n      return {\r\n        repos: result.data||{}\r\n      }\r\n    }else{\r\n      return {\r\n        repos: result.data.data||{}\r\n      }\r\n    }\r\n}\r\n\r\nexport default withRouter(Search)"]},"metadata":{},"sourceType":"module"}