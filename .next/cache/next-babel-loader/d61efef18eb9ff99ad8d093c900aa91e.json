{"ast":null,"code":"import _objectSpread from \"@babel/runtime-corejs2/helpers/esm/objectSpread\";\nimport _objectWithoutProperties from \"@babel/runtime-corejs2/helpers/esm/objectWithoutProperties\";\nimport _Object$entries from \"@babel/runtime-corejs2/core-js/object/entries\";\nimport _JSXStyle from \"styled-jsx/style\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useEffect } from 'react';\nimport Link from 'next/link';\nimport { withRouter } from 'next/router';\nimport { cache, get } from '../lib/repo-cache';\nimport Repo from './Repo';\nimport api from '../lib/api';\n\nfunction makeQuery(queryObject) {\n  const query = _Object$entries(queryObject).reduce((result, item) => {\n    result.push(item.join('='));\n    return result;\n  }, []).join('&');\n\n  return `?${query}`;\n}\n\nconst isServer = true;\nexport default ((Comp, type) => {\n  const withDetail = (_ref) => {\n    let {\n      repobasic,\n      router\n    } = _ref,\n        rest = _objectWithoutProperties(_ref, [\"repobasic\", \"router\"]);\n\n    console.log(repobasic);\n    const query = makeQuery(router.query);\n    useEffect(() => {\n      !isServer && cache(repobasic);\n    });\n    return __jsx(\"div\", {\n      className: \"jsx-1242838066\" + \" \" + 'root'\n    }, repobasic && repobasic.id ? __jsx(React.Fragment, null, __jsx(\"div\", {\n      className: \"jsx-1242838066\" + \" \" + \"repo-basic\"\n    }, __jsx(Repo, {\n      repo: repobasic\n    }), __jsx(\"div\", {\n      className: \"jsx-1242838066\" + \" \" + 'tabs'\n    }, type === 'index' ? __jsx(\"span\", {\n      className: \"jsx-1242838066\" + \" \" + \"tab index\"\n    }, \"Readme\") : __jsx(Link, {\n      href: `/detail${query}`\n    }, __jsx(\"a\", {\n      className: \"jsx-1242838066\" + \" \" + \"tab index\"\n    }, \"Readme\")), type === 'issues' ? __jsx(\"span\", {\n      className: \"jsx-1242838066\" + \" \" + \"tab issues\"\n    }, \"issues\") : __jsx(Link, {\n      href: `/detail/issues${query}`\n    }, __jsx(\"a\", {\n      className: \"jsx-1242838066\" + \" \" + \"tab index\"\n    }, \"issues\")))), __jsx(Comp, rest)) : '暂无内容', __jsx(_JSXStyle, {\n      id: \"1242838066\"\n    }, \".root.jsx-1242838066{padding-top:20px;}.repo-basic.jsx-1242838066{padding:20px;border:1px solid #eee;margin-bottom:20px;border-radius:5px;}.tab.jsx-1242838066+.tab.jsx-1242838066{margin-left:20px;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbWFyaW1vXFxEZXNrdG9wXFxuZXh0LWdpdGh1YlxcY29tcG9uZW50c1xcd2l0aERldGFpbC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFpRGtCLEFBRzhCLEFBR0osQUFNSSxhQUxLLElBSHhCLEFBU0Esa0JBTHFCLG1CQUNELGtCQUNwQiIsImZpbGUiOiJDOlxcVXNlcnNcXG1hcmltb1xcRGVza3RvcFxcbmV4dC1naXRodWJcXGNvbXBvbmVudHNcXHdpdGhEZXRhaWwuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge3VzZUVmZmVjdH0gZnJvbSAncmVhY3QnXHJcbmltcG9ydCBMaW5rIGZyb20gJ25leHQvbGluaydcclxuaW1wb3J0IHsgd2l0aFJvdXRlciB9IGZyb20gJ25leHQvcm91dGVyJ1xyXG5cclxuaW1wb3J0IHtjYWNoZSxnZXR9IGZyb20gJy4uL2xpYi9yZXBvLWNhY2hlJ1xyXG5pbXBvcnQgUmVwbyBmcm9tICcuL1JlcG8nXHJcbmltcG9ydCBhcGkgZnJvbSAnLi4vbGliL2FwaSdcclxuXHJcbmZ1bmN0aW9uIG1ha2VRdWVyeShxdWVyeU9iamVjdCl7XHJcbiAgY29uc3QgcXVlcnk9T2JqZWN0LmVudHJpZXMocXVlcnlPYmplY3QpXHJcbiAgICAucmVkdWNlKChyZXN1bHQsaXRlbSk9PntcclxuICAgICAgcmVzdWx0LnB1c2goaXRlbS5qb2luKCc9JykpXHJcbiAgICAgIHJldHVybiByZXN1bHRcclxuICB9LFtdKVxyXG4gICAgLmpvaW4oJyYnKVxyXG4gIHJldHVybiBgPyR7cXVlcnl9YFxyXG59XHJcblxyXG5jb25zdCBpc1NlcnZlciA9IHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnXHJcblxyXG5leHBvcnQgZGVmYXVsdCAoQ29tcCx0eXBlKT0+e1xyXG4gIGNvbnN0IHdpdGhEZXRhaWw9KHsgcmVwb2Jhc2ljLCByb3V0ZXIsIC4uLnJlc3QgfSk9PntcclxuICAgIGNvbnNvbGUubG9nKHJlcG9iYXNpYylcclxuICAgIGNvbnN0IHF1ZXJ5ID0gbWFrZVF1ZXJ5KHJvdXRlci5xdWVyeSlcclxuICAgIHVzZUVmZmVjdCgoKSA9PiB7XHJcbiAgICAgICFpc1NlcnZlciAmJiBjYWNoZShyZXBvYmFzaWMpXHJcbiAgICB9KVxyXG4gICAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPSdyb290Jz5cclxuICAgICAge1xyXG4gICAgICAgIHJlcG9iYXNpYyYmcmVwb2Jhc2ljLmlkXHJcbiAgICAgICAgPzw+PGRpdiBjbGFzc05hbWU9XCJyZXBvLWJhc2ljXCI+XHJcbiAgICAgICAgPFJlcG8gcmVwbz17cmVwb2Jhc2ljfSAvPlxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPSd0YWJzJz5cclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgIHR5cGU9PT0naW5kZXgnXHJcbiAgICAgICAgICAgICAgPzxzcGFuIGNsYXNzTmFtZT1cInRhYiBpbmRleFwiPlJlYWRtZTwvc3Bhbj5cclxuICAgICAgICAgICAgICA6PExpbmsgaHJlZj17YC9kZXRhaWwke3F1ZXJ5fWB9PjxhIGNsYXNzTmFtZT1cInRhYiBpbmRleFwiPlJlYWRtZTwvYT48L0xpbms+XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgIHR5cGU9PT0naXNzdWVzJ1xyXG4gICAgICAgICAgICAgID88c3BhbiBjbGFzc05hbWU9XCJ0YWIgaXNzdWVzXCI+aXNzdWVzPC9zcGFuPlxyXG4gICAgICAgICAgICAgIDo8TGluayBocmVmPXtgL2RldGFpbC9pc3N1ZXMke3F1ZXJ5fWB9PjxhIGNsYXNzTmFtZT1cInRhYiBpbmRleFwiPmlzc3VlczwvYT48L0xpbms+XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgPC9kaXY+XHJcbiAgICAgIDxDb21wIHsuLi5yZXN0fSAvPjwvPlxyXG4gICAgICA6J+aaguaXoOWGheWuuSdcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgPHN0eWxlIGpzeD57YFxyXG4gICAgICAgICAgLnJvb3Qge1xyXG4gICAgICAgICAgICBwYWRkaW5nLXRvcDogMjBweDtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIC5yZXBvLWJhc2ljIHtcclxuICAgICAgICAgICAgcGFkZGluZzogMjBweDtcclxuICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgI2VlZTtcclxuICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogMjBweDtcclxuICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNXB4O1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgLnRhYiArIC50YWIge1xyXG4gICAgICAgICAgICBtYXJnaW4tbGVmdDogMjBweDtcclxuICAgICAgICAgIH1cclxuICAgICAgICBgfTwvc3R5bGU+XHJcbiAgICA8L2Rpdj5cclxuICB9XHJcbiAgd2l0aERldGFpbC5nZXRJbml0aWFsUHJvcHM9IGFzeW5jIChjb250ZXh0KT0+e1xyXG4gICAgY29uc3QgeyBjdHggfSA9IGNvbnRleHRcclxuICAgIGNvbnN0IHsgb3duZXIsIG5hbWUgfSA9IGN0eC5xdWVyeVxyXG4gICAgY29uc3QgZnVsbF9uYW1lID0gYCR7b3duZXJ9LyR7bmFtZX1gXHJcbiAgICBsZXQgcGFnZURhdGE9e31cclxuICAgIFxyXG4gICAgaWYoQ29tcCYmQ29tcC5nZXRJbml0aWFsUHJvcHMpe1xyXG4gICAgICBwYWdlRGF0YSA9YXdhaXQgQ29tcC5nZXRJbml0aWFsUHJvcHMoY29udGV4dClcclxuICAgIH1cclxuICAgIGlmKGdldChmdWxsX25hbWUpKSB7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgcmVwb2Jhc2ljOiBnZXQoZnVsbF9uYW1lKSxcclxuICAgICAgICAuLi5wYWdlRGF0YVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBsZXQgcmVwb0Jhc2ljPXt9XHJcbiAgICB0cnkge1xyXG4gICAgIHJlcG9CYXNpYyA9IGF3YWl0IGFwaS5yZXF1ZXN0KFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIHVybDogYC9yZXBvcy8ke2Z1bGxfbmFtZX1gXHJcbiAgICAgICAgfSxcclxuICAgICAgICBjdHgucmVxLFxyXG4gICAgICAgIGN0eC5yZXNcclxuICAgICAgKVxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5sb2coJ2Vycm9yJylcclxuICAgIH1cclxuICAgIHJldHVybiB7XHJcbiAgICAgIHJlcG9iYXNpYzogaXNTZXJ2ZXI/cmVwb0Jhc2ljLmRhdGE6cmVwb0Jhc2ljLmRhdGEuZGF0YSxcclxuICAgICAgLi4ucGFnZURhdGFcclxuICAgIH1cclxuXHJcbiAgfVxyXG4gIHJldHVybiB3aXRoUm91dGVyKHdpdGhEZXRhaWwpXHJcbn0iXX0= */\\n/*@ sourceURL=C:\\\\Users\\\\marimo\\\\Desktop\\\\next-github\\\\components\\\\withDetail.js */\"));\n  };\n\n  withDetail.getInitialProps = async context => {\n    const {\n      ctx\n    } = context;\n    const {\n      owner,\n      name\n    } = ctx.query;\n    const full_name = `${owner}/${name}`;\n    let pageData = {};\n\n    if (Comp && Comp.getInitialProps) {\n      pageData = await Comp.getInitialProps(context);\n    }\n\n    if (get(full_name)) {\n      return _objectSpread({\n        repobasic: get(full_name)\n      }, pageData);\n    }\n\n    let repoBasic = {};\n\n    try {\n      repoBasic = await api.request({\n        url: `/repos/${full_name}`\n      }, ctx.req, ctx.res);\n    } catch (error) {\n      console.log('error');\n    }\n\n    return _objectSpread({\n      repobasic: isServer ? repoBasic.data : repoBasic.data.data\n    }, pageData);\n  };\n\n  return withRouter(withDetail);\n});","map":{"version":3,"sources":["C:\\Users\\marimo\\Desktop\\next-github\\components\\withDetail.js"],"names":["useEffect","Link","withRouter","cache","get","Repo","api","makeQuery","queryObject","query","reduce","result","item","push","join","isServer","Comp","type","withDetail","repobasic","router","rest","console","log","id","getInitialProps","context","ctx","owner","name","full_name","pageData","repoBasic","request","url","req","res","error","data"],"mappings":";;;;;;AAAA,SAAQA,SAAR,QAAwB,OAAxB;AACA,OAAOC,IAAP,MAAiB,WAAjB;AACA,SAASC,UAAT,QAA2B,aAA3B;AAEA,SAAQC,KAAR,EAAcC,GAAd,QAAwB,mBAAxB;AACA,OAAOC,IAAP,MAAiB,QAAjB;AACA,OAAOC,GAAP,MAAgB,YAAhB;;AAEA,SAASC,SAAT,CAAmBC,WAAnB,EAA+B;AAC7B,QAAMC,KAAK,GAAC,gBAAeD,WAAf,EACTE,MADS,CACF,CAACC,MAAD,EAAQC,IAAR,KAAe;AACrBD,IAAAA,MAAM,CAACE,IAAP,CAAYD,IAAI,CAACE,IAAL,CAAU,GAAV,CAAZ;AACA,WAAOH,MAAP;AACH,GAJW,EAIV,EAJU,EAKTG,IALS,CAKJ,GALI,CAAZ;;AAMA,SAAQ,IAAGL,KAAM,EAAjB;AACD;;AAED,MAAMM,QAAQ,OAAd;AAEA,gBAAe,CAACC,IAAD,EAAMC,IAAN,KAAa;AAC1B,QAAMC,UAAU,GAAC,UAAkC;AAAA,QAAjC;AAAEC,MAAAA,SAAF;AAAaC,MAAAA;AAAb,KAAiC;AAAA,QAATC,IAAS;;AACjDC,IAAAA,OAAO,CAACC,GAAR,CAAYJ,SAAZ;AACA,UAAMV,KAAK,GAAGF,SAAS,CAACa,MAAM,CAACX,KAAR,CAAvB;AACAT,IAAAA,SAAS,CAAC,MAAM;AACd,OAACe,QAAD,IAAaZ,KAAK,CAACgB,SAAD,CAAlB;AACD,KAFQ,CAAT;AAGA,WAAO;AAAA,0CAAe;AAAf,OAEHA,SAAS,IAAEA,SAAS,CAACK,EAArB,GACC,4BAAE;AAAA,0CAAe;AAAf,OACH,MAAC,IAAD;AAAM,MAAA,IAAI,EAAEL;AAAZ,MADG,EAEH;AAAA,0CAAe;AAAf,OAEMF,IAAI,KAAG,OAAP,GACC;AAAA,0CAAgB;AAAhB,gBADD,GAEC,MAAC,IAAD;AAAM,MAAA,IAAI,EAAG,UAASR,KAAM;AAA5B,OAA+B;AAAA,0CAAa;AAAb,gBAA/B,CAJP,EAOMQ,IAAI,KAAG,QAAP,GACC;AAAA,0CAAgB;AAAhB,gBADD,GAEC,MAAC,IAAD;AAAM,MAAA,IAAI,EAAG,iBAAgBR,KAAM;AAAnC,OAAsC;AAAA,0CAAa;AAAb,gBAAtC,CATP,CAFG,CAAF,EAeH,MAAC,IAAD,EAAUY,IAAV,CAfG,CADD,GAiBD,MAnBI;AAAA;AAAA,szIAAP;AAqCD,GA3CD;;AA4CAH,EAAAA,UAAU,CAACO,eAAX,GAA4B,MAAOC,OAAP,IAAiB;AAC3C,UAAM;AAAEC,MAAAA;AAAF,QAAUD,OAAhB;AACA,UAAM;AAAEE,MAAAA,KAAF;AAASC,MAAAA;AAAT,QAAkBF,GAAG,CAAClB,KAA5B;AACA,UAAMqB,SAAS,GAAI,GAAEF,KAAM,IAAGC,IAAK,EAAnC;AACA,QAAIE,QAAQ,GAAC,EAAb;;AAEA,QAAGf,IAAI,IAAEA,IAAI,CAACS,eAAd,EAA8B;AAC5BM,MAAAA,QAAQ,GAAE,MAAMf,IAAI,CAACS,eAAL,CAAqBC,OAArB,CAAhB;AACD;;AACD,QAAGtB,GAAG,CAAC0B,SAAD,CAAN,EAAmB;AACjB;AACEX,QAAAA,SAAS,EAAEf,GAAG,CAAC0B,SAAD;AADhB,SAEKC,QAFL;AAID;;AACD,QAAIC,SAAS,GAAC,EAAd;;AACA,QAAI;AACHA,MAAAA,SAAS,GAAG,MAAM1B,GAAG,CAAC2B,OAAJ,CACf;AACEC,QAAAA,GAAG,EAAG,UAASJ,SAAU;AAD3B,OADe,EAIfH,GAAG,CAACQ,GAJW,EAKfR,GAAG,CAACS,GALW,CAAlB;AAOA,KARD,CAQE,OAAOC,KAAP,EAAc;AACdf,MAAAA,OAAO,CAACC,GAAR,CAAY,OAAZ;AACD;;AACD;AACEJ,MAAAA,SAAS,EAAEJ,QAAQ,GAACiB,SAAS,CAACM,IAAX,GAAgBN,SAAS,CAACM,IAAV,CAAeA;AADpD,OAEKP,QAFL;AAKD,GAhCD;;AAiCA,SAAO7B,UAAU,CAACgB,UAAD,CAAjB;AACD,CA/ED","sourcesContent":["import {useEffect} from 'react'\r\nimport Link from 'next/link'\r\nimport { withRouter } from 'next/router'\r\n\r\nimport {cache,get} from '../lib/repo-cache'\r\nimport Repo from './Repo'\r\nimport api from '../lib/api'\r\n\r\nfunction makeQuery(queryObject){\r\n  const query=Object.entries(queryObject)\r\n    .reduce((result,item)=>{\r\n      result.push(item.join('='))\r\n      return result\r\n  },[])\r\n    .join('&')\r\n  return `?${query}`\r\n}\r\n\r\nconst isServer = typeof window === 'undefined'\r\n\r\nexport default (Comp,type)=>{\r\n  const withDetail=({ repobasic, router, ...rest })=>{\r\n    console.log(repobasic)\r\n    const query = makeQuery(router.query)\r\n    useEffect(() => {\r\n      !isServer && cache(repobasic)\r\n    })\r\n    return <div className='root'>\r\n      {\r\n        repobasic&&repobasic.id\r\n        ?<><div className=\"repo-basic\">\r\n        <Repo repo={repobasic} />\r\n        <div className='tabs'>\r\n            {\r\n              type==='index'\r\n              ?<span className=\"tab index\">Readme</span>\r\n              :<Link href={`/detail${query}`}><a className=\"tab index\">Readme</a></Link>\r\n            }\r\n            {\r\n              type==='issues'\r\n              ?<span className=\"tab issues\">issues</span>\r\n              :<Link href={`/detail/issues${query}`}><a className=\"tab index\">issues</a></Link>\r\n            }\r\n        </div>\r\n      </div>\r\n      <Comp {...rest} /></>\r\n      :'暂无内容'\r\n      }\r\n      \r\n      <style jsx>{`\r\n          .root {\r\n            padding-top: 20px;\r\n          }\r\n          .repo-basic {\r\n            padding: 20px;\r\n            border: 1px solid #eee;\r\n            margin-bottom: 20px;\r\n            border-radius: 5px;\r\n          }\r\n          .tab + .tab {\r\n            margin-left: 20px;\r\n          }\r\n        `}</style>\r\n    </div>\r\n  }\r\n  withDetail.getInitialProps= async (context)=>{\r\n    const { ctx } = context\r\n    const { owner, name } = ctx.query\r\n    const full_name = `${owner}/${name}`\r\n    let pageData={}\r\n    \r\n    if(Comp&&Comp.getInitialProps){\r\n      pageData =await Comp.getInitialProps(context)\r\n    }\r\n    if(get(full_name)) {\r\n      return {\r\n        repobasic: get(full_name),\r\n        ...pageData\r\n      }\r\n    }\r\n    let repoBasic={}\r\n    try {\r\n     repoBasic = await api.request(\r\n        {\r\n          url: `/repos/${full_name}`\r\n        },\r\n        ctx.req,\r\n        ctx.res\r\n      )\r\n    } catch (error) {\r\n      console.log('error')\r\n    }\r\n    return {\r\n      repobasic: isServer?repoBasic.data:repoBasic.data.data,\r\n      ...pageData\r\n    }\r\n\r\n  }\r\n  return withRouter(withDetail)\r\n}"]},"metadata":{},"sourceType":"module"}